<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Spark Ad Studio | Reklam UygulamasÄ±</title>

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet" />

  <style>
    :root {
      --bg: #050816;
      --bg-soft: #0b1020;
      --accent: #ff7a3c;
      --accent-soft: #ffd3b8;
      --text: #f5f5f5;
      --muted: #b3b7c9;
      --card: #11182b;
      --radius-xl: 18px;
      --shadow-soft: 0 18px 40px rgba(0, 0, 0, 0.45);
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: "Poppins", system-ui, -apple-system, BlinkMacSystemFont,
        "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #11182b 0, #050816 55%, #04030a 100%);
      color: var(--text);
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
    }

    a { color: inherit; text-decoration: none; }
    img { max-width: 100%; display: block; }

    .container {
      width: min(1120px, 92vw);
      margin: 0 auto;
    }

    .hidden { display: none !important; }

    /* HEADER */
    header {
      position: sticky;
      top: 0;
      z-index: 50;
      backdrop-filter: blur(18px);
      background: linear-gradient(to bottom, rgba(5, 8, 22, 0.94), transparent);
      border-bottom: 1px solid rgba(255, 255, 255, 0.04);
    }

    .nav {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 0;
      gap: 12px;
    }

    .nav-left {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .nav-logo-img {
      width: 40px;
      height: 40px;
      border-radius: 14px;
      object-fit: contain;
      background: #fff;
      padding: 4px;
      box-shadow: 0 10px 24px rgba(0, 0, 0, 0.4);
    }

    .nav-title {
      font-weight: 600;
      font-size: 18px;
      letter-spacing: 0.03em;
    }

    .nav-sub {
      font-size: 11px;
      color: var(--muted);
    }

    .nav-right {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .nav-links {
      display: flex;
      gap: 14px;
      font-size: 13px;
      color: var(--muted);
    }

    .nav-link-btn {
      background: transparent;
      border: none;
      color: var(--muted);
      cursor: pointer;
      padding: 4px 6px;
    }

    .nav-link-btn:hover { color: var(--accent); }

    .nav-cta {
      padding: 7px 14px;
      border-radius: 999px;
      background: linear-gradient(135deg, #ff7a3c, #ffb347);
      color: #111;
      font-size: 13px;
      font-weight: 600;
      box-shadow: 0 10px 24px rgba(0, 0, 0, 0.55);
      border: none;
      cursor: pointer;
      transition: transform 0.12s ease, box-shadow 0.12s ease;
    }

    .nav-cta:hover {
      transform: translateY(-1px);
      box-shadow: 0 14px 30px rgba(0, 0, 0, 0.6);
    }

    main { padding-bottom: 40px; }
    .screen { padding: 40px 0; }

    /* INFO / HERO */
    .info-layout {
      display: grid;
      grid-template-columns: minmax(0,1.2fr) minmax(0,1fr);
      gap: 28px;
      align-items: center;
    }

    .hero-kicker {
      font-size: 11px;
      letter-spacing: 0.22em;
      text-transform: uppercase;
      color: var(--accent-soft);
      display: inline-flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 10px;
    }

    .dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: var(--accent);
    }

    h1 {
      font-size: clamp(30px, 4.8vw, 40px);
      font-weight: 700;
      line-height: 1.1;
      margin-bottom: 10px;
    }

    h1 span {
      background: linear-gradient(135deg, #ffb347, #ff7a3c, #ff4b6a);
      -webkit-background-clip: text;
      color: transparent;
    }

    .lead {
      font-size: 14px;
      color: var(--muted);
      max-width: 520px;
      margin-bottom: 18px;
    }

    .card {
      background: var(--card);
      border-radius: var(--radius-xl);
      padding: 16px 16px 14px;
      border: 1px solid rgba(255, 255, 255, 0.05);
      box-shadow: 0 14px 32px rgba(0, 0, 0, 0.5);
      font-size: 13px;
    }

    .card h3 { font-size: 15px; margin-bottom: 6px; }

    .info-badges {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin: 10px 0 18px;
      font-size: 11px;
    }

    .info-badge {
      padding: 4px 9px;
      border-radius: 999px;
      background: rgba(15,23,42,0.9);
      border: 1px solid rgba(148,163,184,0.4);
      color: var(--accent-soft);
    }

    .info-btn {
      padding: 10px 18px;
      border-radius: 999px;
      border: none;
      background: linear-gradient(135deg, #ff7a3c, #ff4b6a);
      color: #111;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      box-shadow: var(--shadow-soft);
      margin-top: 10px;
    }

    .info-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.7);
    }

    /* AUTH */
    .auth-wrapper {
      max-width: 420px;
      margin: 0 auto;
    }

    .auth-title {
      text-align: center;
      font-size: 20px;
      margin-bottom: 10px;
    }

    .auth-sub {
      text-align: center;
      font-size: 13px;
      color: var(--muted);
      margin-bottom: 20px;
    }

    .auth-card {
      background: var(--card);
      border-radius: 16px;
      padding: 18px 16px 16px;
      border: 1px solid rgba(255, 255, 255, 0.08);
      box-shadow: var(--shadow-soft);
    }

    .auth-tabs {
      display: flex;
      margin-bottom: 14px;
      border-radius: 999px;
      background: rgba(5,8,22,0.9);
      padding: 3px;
    }

    .auth-tab {
      flex: 1;
      text-align: center;
      padding: 6px 0;
      font-size: 13px;
      border-radius: 999px;
      cursor: pointer;
      color: var(--muted);
    }

    .auth-tab.active {
      background: linear-gradient(135deg, #ff7a3c, #ffb347);
      color: #111;
      font-weight: 600;
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 4px;
      margin-bottom: 10px;
    }

    .field label {
      font-size: 12px;
      color: var(--muted);
    }

    .field input {
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.12);
      padding: 8px 10px;
      background: rgba(5, 8, 22, 0.8);
      color: var(--text);
      font-size: 13px;
      outline: none;
    }

    .field input::placeholder {
      color: #666c85;
    }

    .btn-primary {
      width: 100%;
      padding: 9px 14px;
      border-radius: 999px;
      border: none;
      background: linear-gradient(135deg, #ff7a3c, #ff4b6a);
      color: #111;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      box-shadow: var(--shadow-soft);
      margin-top: 4px;
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.7);
    }

    .auth-status {
      font-size: 12px;
      color: var(--accent-soft);
      min-height: 16px;
      margin-top: 8px;
    }

    /* MAIN */
    .welcome {
      font-size: 14px;
      color: var(--accent-soft);
      margin-bottom: 10px;
    }

    .section-title {
      font-size: 22px;
      font-weight: 600;
      margin-bottom: 6px;
    }

    .section-desc {
      font-size: 14px;
      color: var(--muted);
      margin-bottom: 18px;
    }

    .notification-list {
      margin-top: 8px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,0.08);
      background: rgba(11,16,32,0.95);
      padding: 10px;
      font-size: 13px;
    }

    .notif-item {
      padding: 8px 6px;
      border-bottom: 1px solid rgba(255,255,255,0.06);
    }

    .notif-item:last-child { border-bottom: none; }

    .notif-meta {
      font-size: 11px;
      color: var(--accent-soft);
      margin-bottom: 2px;
    }

    .status-pill {
      display: inline-block;
      padding: 2px 7px;
      border-radius: 999px;
      font-size: 10px;
      margin-left: 6px;
    }

    .status-pending {
      background: rgba(234,179,8,0.15);
      color: #facc15;
    }

    .status-approved {
      background: rgba(22,163,74,0.2);
      color: #4ade80;
    }

    .status-rejected {
      background: rgba(239,68,68,0.18);
      color: #fca5a5;
    }

    /* SETTINGS */
    .settings-grid {
      display: grid;
      grid-template-columns: minmax(0,1.1fr) minmax(0,1.1fr);
      gap: 18px;
    }

    .textarea {
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.12);
      padding: 8px 10px;
      background: rgba(5, 8, 22, 0.8);
      color: var(--text);
      font-size: 13px;
      outline: none;
      min-height: 90px;
      resize: vertical;
    }

    /* ADMIN */
    .admin-card {
      background: rgba(11,16,32,0.95);
      border-radius: 18px;
      padding: 16px;
      border: 1px solid rgba(255,255,255,0.08);
      box-shadow: 0 14px 32px rgba(0,0,0,0.5);
      font-size: 13px;
      color: var(--muted);
      margin-bottom: 18px;
    }

    .admin-list {
      margin-top: 8px;
      max-height: 260px;
      overflow-y: auto;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,0.06);
      padding: 8px;
      background: rgba(4,6,18,0.9);
      font-size: 12px;
    }

    .submission-item {
      padding: 6px 4px;
      border-bottom: 1px solid rgba(255,255,255,0.06);
    }

    .submission-item:last-child { border-bottom: none; }

    .submission-meta {
      font-size: 11px;
      color: var(--accent-soft);
      margin-bottom: 2px;
    }

    .admin-actions {
      margin-top: 4px;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      align-items: center;
    }

    .admin-actions input {
      border-radius: 999px;
      padding: 4px 8px;
      border: 1px solid rgba(255,255,255,0.14);
      background: rgba(5,8,22,0.8);
      color: var(--text);
      font-size: 11px;
      flex: 1;
      min-width: 140px;
    }

    .btn-approve,
    .btn-reject {
      padding: 4px 9px;
      border-radius: 999px;
      border: none;
      font-size: 11px;
      cursor: pointer;
    }

    .btn-approve {
      background: rgba(22,163,74,0.9);
      color: #e5f9ed;
    }

    .btn-reject {
      background: rgba(239,68,68,0.9);
      color: #fee2e2;
    }

    footer {
      padding: 18px 0 22px;
      font-size: 12px;
      color: var(--muted);
    }

    footer .row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: space-between;
      align-items: center;
    }

    footer a { color: var(--accent-soft); font-size: 12px; }

    @media (max-width: 820px) {
      .info-layout { grid-template-columns: 1fr; }
      .settings-grid { grid-template-columns: 1fr; }
    }

  </style>
</head>

<body>
<header id="top">
  <div class="container nav">
    <div class="nav-left">
      <img src="spark-logo.png" alt="Spark Ad Studio" class="nav-logo-img" />
      <div>
        <div class="nav-title">Spark Ad Studio</div>
        <div class="nav-sub">KulÃ¼pler & Markalar Ä°Ã§in Reklam</div>
      </div>
    </div>
    <div class="nav-right">
      <div class="nav-links hidden" id="navLinks">
        <button class="nav-link-btn" onclick="navigateMain()">Ana Sayfa</button>
        <button class="nav-link-btn" onclick="navigateSettings()">StÃ¼dyo & Ayarlar</button>
      </div>
      <button class="nav-cta" id="mainActionBtn">Ãœye Ol / GiriÅŸ Yap</button>
    </div>
  </div>
</header>

<main>
  <!-- BÄ°LGÄ° SAYFASI -->
  <div id="screen-info" class="screen">
    <div class="container info-layout">
      <div>
        <div class="hero-kicker">
          <span class="dot"></span> KULÃœPLER VE MARKALAR Ä°Ã‡Ä°N MÄ°NÄ° STÃœDYO
        </div>
        <h1><span>Spark Ad Studio</span> ile akÄ±lda kalÄ±cÄ± reklamlar Ã¼ret.</h1>
        <p class="lead">
          Spark Ad Studio, kulÃ¼pler ve markalar iÃ§in genÃ§ bakÄ±ÅŸ aÃ§Ä±sÄ±yla reklam
          fikirleri Ã¼reten mini bir dijital stÃ¼dyo. Ãœye olup giriÅŸ yaptÄ±ktan sonra,
          reklam isteklerini gÃ¶nderip YÃ¶neticiâ€™nin geri dÃ¶nÃ¼ÅŸlerini bildirimler
          kÄ±smÄ±ndan takip edebilirsin.
        </p>
        <div class="info-badges">
          <span class="info-badge">ğŸ® GenÃ§ odaklÄ± kreatif fikirler</span>
          <span class="info-badge">ğŸŸ KulÃ¼pler ve markalar iÃ§in</span>
          <span class="info-badge">âœ‰ï¸ YÃ¶neticiye direkt mesaj</span>
        </div>
        <button class="info-btn" onclick="showScreen('auth')">Ãœye Ol / GiriÅŸ Yap</button>
      </div>

      <div class="card">
        <h3>Bu stÃ¼dyo nasÄ±l Ã§alÄ±ÅŸÄ±yor?</h3>
        <p style="font-size:13px;color:var(--muted);margin-bottom:8px;">
          Ãœye olduktan sonra:
        </p>
        <ul style="font-size:13px;color:var(--muted);margin-left:18px;">
          <li>â€œStÃ¼dyo & Ayarlarâ€ kÄ±smÄ±ndan reklam isteÄŸi gÃ¶nderirsin,</li>
          <li>YÃ¶netici isteÄŸini inceler, onaylar veya reddeder,</li>
          <li>SonuÃ§larÄ± ana sayfadaki bildirimlerden takip edersin.</li>
        </ul>
        <p style="font-size:12px;color:var(--accent-soft);margin-top:10px;">
          Telefon: <strong>0534 969 30 20</strong>
        </p>
      </div>
    </div>
  </div>

  <!-- GÄ°RÄ°Å / ÃœYE OL -->
  <div id="screen-auth" class="screen hidden">
    <div class="container auth-wrapper">
      <div class="auth-title">HesabÄ±na giriÅŸ yap veya Ã¼ye ol</div>
      <div class="auth-sub">
        Ãœyelik sonrasÄ± ana sayfaya dÃ¼ÅŸersin ve reklam isteklerini takip edebilirsin.
      </div>

      <div class="auth-card">
        <div class="auth-tabs">
          <div id="tab-login" class="auth-tab active" onclick="switchAuthTab('login')">GiriÅŸ Yap</div>
          <div id="tab-register" class="auth-tab" onclick="switchAuthTab('register')">Ãœye Ol</div>
        </div>

        <!-- GÄ°RÄ°Å FORMU -->
        <div id="login-form">
          <div class="field">
            <label for="loginUsername">KullanÄ±cÄ± adÄ± veya email</label>
            <input id="loginUsername" type="text" placeholder="kullanÄ±cÄ± adÄ± veya email" />
          </div>
          <div class="field">
            <label for="loginPass">Åifre</label>
            <input id="loginPass" type="password" placeholder="Åifren" />
          </div>
          <button class="btn-primary" onclick="loginUser()">GiriÅŸ Yap</button>
          <div class="auth-status" id="authStatus"></div>
        </div>

        <!-- ÃœYE OL FORMU -->
        <div id="register-form" class="hidden">
          <div class="field">
            <label for="signupUsername">KullanÄ±cÄ± adÄ±</label>
            <input id="signupUsername" type="text" placeholder="Ã–rn: emir07" />
          </div>
          <div class="field">
            <label for="signupEmail">E-posta</label>
            <input id="signupEmail" type="email" placeholder="ornek@mail.com" />
          </div>
          <div class="field">
            <label for="signupPass">Åifre</label>
            <input id="signupPass" type="password" placeholder="Bir ÅŸifre belirle" />
          </div>
          <button class="btn-primary" onclick="signupUser()">Ãœye Ol ve Ana Sayfaya GeÃ§</button>
          <div class="auth-status" id="authStatusRegister"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- ANA SAYFA (BÄ°LDÄ°RÄ°MLER) -->
  <div id="screen-main" class="screen hidden">
    <div class="container">
      <div class="welcome">HoÅŸ geldin, <span id="welcomeUser"></span> ğŸ‘‹</div>
      <h2 class="section-title">Bildirimler</h2>
      <p class="section-desc">
        GÃ¶nderdiÄŸin reklam isteklerinin onay / red durumlarÄ±nÄ± buradan takip edebilirsin.
      </p>
      <div class="notification-list" id="notifList"></div>
    </div>
  </div>

  <!-- STÃœDYO & AYARLAR -->
  <div id="screen-settings" class="screen hidden">
    <div class="container">
      <div class="welcome">StÃ¼dyo & Ayarlar</div>
      <h2 class="section-title">Profil ve Reklam Ä°stekleri</h2>
      <p class="section-desc">
        Buradan profilini gÃ¶rebilir, reklam isteÄŸi gÃ¶nderebilir ve YÃ¶neticiye mesaj atabilirsin.
      </p>

      <div class="settings-grid">
        <!-- Profil -->
        <div class="card">
          <h3>Profil Bilgilerin</h3>
          <p id="profileInfo" style="font-size:13px;color:var(--muted);margin-top:8px;"></p>
        </div>

        <!-- Reklam Ä°steÄŸi -->
        <div class="card">
          <h3>Reklam Ä°steÄŸi GÃ¶nder</h3>
          <p style="font-size:12px;color:var(--muted);">
            Hangi kulÃ¼p/marka iÃ§in nasÄ±l bir reklam istediÄŸini kÄ±saca anlat.
          </p>
          <div class="field">
            <label for="reqBrand">Marka / KulÃ¼p adÄ±</label>
            <input id="reqBrand" type="text" placeholder="Ã–rn: X Spor KulÃ¼bÃ¼" />
          </div>
          <div class="field">
            <label for="reqProduct">ÃœrÃ¼n / kampanya</label>
            <input id="reqProduct" type="text" placeholder="Ã–rn: Yeni forma tanÄ±tÄ±mÄ±" />
          </div>
          <div class="field">
            <label for="reqDesc">Detay</label>
            <textarea id="reqDesc" class="textarea" placeholder="Hedef kitle, tarz, platform vb."></textarea>
          </div>
          <button class="btn-primary" style="width:auto;" onclick="handleAdRequest()">Reklam Ä°steÄŸini GÃ¶nder</button>
          <div class="auth-status" id="reqStatus"></div>
        </div>

        <!-- YÃ¶neticiye Mesaj -->
        <div class="card">
          <h3>YÃ¶neticiye Mesaj GÃ¶nder</h3>
          <p style="font-size:12px;color:var(--muted);">
            Soru, Ã¶neri veya proje fikrini buradan YÃ¶neticiye iletebilirsin.
          </p>
          <div class="field">
            <label for="msgSubject">Konu</label>
            <input id="msgSubject" type="text" placeholder="KÄ±sa baÅŸlÄ±k" />
          </div>
          <div class="field">
            <label for="msgText">MesajÄ±n</label>
            <textarea id="msgText" class="textarea" placeholder="Ne sÃ¶ylemek istersin?"></textarea>
          </div>
          <button class="btn-primary" style="width:auto;" onclick="handleUserMessage()">MesajÄ± GÃ¶nder</button>
          <div class="auth-status" id="msgStatus"></div>
        </div>

        <!-- Ä°letiÅŸim -->
        <div class="card">
          <h3>Ä°letiÅŸim</h3>
          <p style="font-size:13px;color:var(--muted);">
            Telefon: <strong>0534 969 30 20</strong><br />
            Buradan gÃ¶nderdiÄŸin tÃ¼m istek ve mesajlar YÃ¶netici paneline dÃ¼ÅŸer.
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- YÃ–NETÄ°CÄ° PANELÄ° -->
  <div id="screen-admin" class="screen hidden">
    <div class="container">
      <div class="welcome">YÃ¶netici paneline hoÅŸ geldin ğŸ‘‘</div>
      <h2 class="section-title">Reklam Ä°stekleri, Mesajlar ve Ãœyeler</h2>
      <p class="section-desc">
        Buradan kullanÄ±cÄ±larÄ±n reklam isteklerini onaylayabilir veya reddedebilir,
        gÃ¶nderilen mesajlarÄ± ve Ã¼ye listesini gÃ¶rÃ¼ntÃ¼leyebilirsin.
      </p>

      <div class="admin-card">
        <h3>Reklam Ä°stekleri</h3>
        <div class="admin-list" id="adminRequests"></div>
      </div>

      <div class="admin-card">
        <h3>KullanÄ±cÄ± MesajlarÄ±</h3>
        <div class="admin-list" id="adminMessages"></div>
      </div>

      <div class="admin-card">
        <h3>Ãœyeler</h3>
        <div class="admin-list" id="adminUsers"></div>
      </div>
    </div>
  </div>
</main>

<footer>
  <div class="container row">
    <span>Â© <span id="year"></span> Spark Ad Studio. TÃ¼m haklarÄ± saklÄ±dÄ±r.</span>
    <a href="#top">YukarÄ± Ã§Ä±k â†‘</a>
  </div>
</footer>

<script>
  const ADMIN_PASSWORD = "spark123";
  let currentUser = null;

  document.getElementById("year").textContent = new Date().getFullYear();

  function showScreen(which) {
    ["info","auth","main","settings","admin"].forEach(id => {
      const el = document.getElementById("screen-" + id);
      if (!el) return;
      el.classList.toggle("hidden", id !== which);
    });
  }

  function updateHeader() {
    const navLinks = document.getElementById("navLinks");
    const btn = document.getElementById("mainActionBtn");
    if (currentUser) {
      navLinks.classList.remove("hidden");
      btn.textContent = "Ã‡Ä±kÄ±ÅŸ Yap";
      btn.onclick = logoutUser;
    } else {
      navLinks.classList.add("hidden");
      btn.textContent = "Ãœye Ol / GiriÅŸ Yap";
      btn.onclick = () => showScreen("auth");
    }
  }

  function navigateMain() {
    if (!currentUser) { showScreen("auth"); return; }
    if (currentUser.role === "admin") {
      showScreen("admin");
      renderAdminRequests();
      renderAdminMessages();
      renderAdminUsers();
    } else {
      showScreen("main");
      renderNotifications();
    }
  }

  function navigateSettings() {
    if (!currentUser) { showScreen("auth"); return; }
    if (currentUser.role === "admin") {
      showScreen("admin");
      renderAdminRequests();
      renderAdminMessages();
      renderAdminUsers();
    } else {
      showScreen("settings");
      renderProfile();
    }
  }

  function switchAuthTab(tab) {
    const loginForm = document.getElementById("login-form");
    const registerForm = document.getElementById("register-form");
    const tabLogin = document.getElementById("tab-login");
    const tabRegister = document.getElementById("tab-register");

    if (tab === "login") {
      loginForm.classList.remove("hidden");
      registerForm.classList.add("hidden");
      tabLogin.classList.add("active");
      tabRegister.classList.remove("active");
    } else {
      loginForm.classList.add("hidden");
      registerForm.classList.remove("hidden");
      tabLogin.classList.remove("active");
      tabRegister.classList.add("active");
    }
  }

  function getUsers() {
    return JSON.parse(localStorage.getItem("sparkUsers") || "[]");
  }

  function saveUsers(users) {
    localStorage.setItem("sparkUsers", JSON.stringify(users));
  }

  function signupUser() {
    const username = document.getElementById("signupUsername").value.trim();
    const email = document.getElementById("signupEmail").value.trim();
    const pass = document.getElementById("signupPass").value.trim();
    const status = document.getElementById("authStatusRegister");

    if (!username || !email || !pass) {
      status.textContent = "LÃ¼tfen tÃ¼m alanlarÄ± doldur.";
      return;
    }

    let users = getUsers();
    if (users.find(u => u.username === username || u.email === email)) {
      status.textContent = "Bu kullanÄ±cÄ± adÄ± veya e-posta zaten kullanÄ±lÄ±yor.";
      return;
    }

    const now = new Date().toLocaleString("tr-TR");
    const user = { username, email, pass, role: "user", createdAt: now, lastLogin: now };
    users.push(user);
    saveUsers(users);

    currentUser = user;
    localStorage.setItem("sparkCurrentUser", JSON.stringify(currentUser));
    document.getElementById("welcomeUser").textContent = currentUser.username;
    status.textContent = "";
    updateHeader();
    renderProfile();
    renderNotifications();
    showScreen("main");
  }

  function loginUser() {
    const loginVal = document.getElementById("loginUsername").value.trim();
    const pass = document.getElementById("loginPass").value.trim();
    const status = document.getElementById("authStatus");

    if (!loginVal || !pass) {
      status.textContent = "LÃ¼tfen kullanÄ±cÄ± adÄ±/email ve ÅŸifre gir.";
      return;
    }

    if (loginVal === "admin" && pass === ADMIN_PASSWORD) {
      currentUser = { username: "YÃ¶netici", role: "admin" };
      localStorage.setItem("sparkCurrentUser", JSON.stringify(currentUser));
      status.textContent = "YÃ¶netici olarak giriÅŸ yapÄ±ldÄ±.";
      updateHeader();
      showScreen("admin");
      renderAdminRequests();
      renderAdminMessages();
      renderAdminUsers();
      return;
    }

    let users = getUsers();
    const idx = users.findIndex(
      u => (u.username === loginVal || u.email === loginVal) && u.pass === pass
    );
    if (idx === -1) {
      status.textContent = "KullanÄ±cÄ± bulunamadÄ± veya ÅŸifre hatalÄ±.";
      return;
    }

    const now = new Date().toLocaleString("tr-TR");
    users[idx].lastLogin = now;
    saveUsers(users);

    currentUser = users[idx];
    localStorage.setItem("sparkCurrentUser", JSON.stringify(currentUser));
    document.getElementById("welcomeUser").textContent = currentUser.username;
    status.textContent = "HoÅŸ geldin " + currentUser.username + " ğŸ‰";
    updateHeader();
    renderProfile();
    renderNotifications();
    showScreen("main");
  }

  function logoutUser() {
    currentUser = null;
    localStorage.removeItem("sparkCurrentUser");
    updateHeader();
    showScreen("info");
  }

  function renderProfile() {
    if (!currentUser || currentUser.role !== "user") return;
    const el = document.getElementById("profileInfo");
    const html = `
      KullanÄ±cÄ± adÄ±: <strong>${currentUser.username}</strong><br>
      E-posta: ${currentUser.email}<br>
      Ãœyelik tarihi: ${currentUser.createdAt || "-"}<br>
      Son giriÅŸ: ${currentUser.lastLogin || "-"}
    `;
    el.innerHTML = html;
  }

  function renderNotifications() {
    const box = document.getElementById("notifList");
    if (!box) return;
    if (!currentUser || currentUser.role !== "user") {
      box.innerHTML = "<div>Ã–nce giriÅŸ yapmalÄ±sÄ±n.</div>";
      return;
    }

    let list = JSON.parse(localStorage.getItem("sparkAdRequests") || "[]");
    const myList = list.filter(r => r.user === currentUser.username);
    if (!myList.length) {
      box.innerHTML = "<div>HenÃ¼z reklam isteÄŸin yok. StÃ¼dyo & Ayarlar menÃ¼sÃ¼nden yeni bir istek gÃ¶nderebilirsin.</div>";
      return;
    }

    box.innerHTML = myList.map(req => {
      const statusClass =
        req.status === "approved"
          ? "status-approved"
          : req.status === "rejected"
          ? "status-rejected"
          : "status-pending";
      const statusText =
        req.status === "approved"
          ? "OnaylandÄ±"
          : req.status === "rejected"
          ? "Reddedildi"
          : "Beklemede";
      return `
        <div class="notif-item">
          <div class="notif-meta">
            ${req.date} â€“ <strong>${req.brand}</strong> (${req.product})
            <span class="status-pill ${statusClass}">${statusText}</span>
          </div>
          <div>${req.desc}</div>
          ${req.adminMessage ? `<div style="margin-top:4px;font-size:12px;">YÃ¶netici notu: ${req.adminMessage}</div>` : ""}
        </div>
      `;
    }).join("");
  }

  function handleAdRequest() {
    const statusEl = document.getElementById("reqStatus");
    if (!currentUser || currentUser.role !== "user") {
      statusEl.textContent = "Ã–nce kullanÄ±cÄ± olarak giriÅŸ yapmalÄ±sÄ±n.";
      return;
    }

    const brand = document.getElementById("reqBrand").value.trim();
    const product = document.getElementById("reqProduct").value.trim();
    const desc = document.getElementById("reqDesc").value.trim();

    if (!brand || !product || !desc) {
      statusEl.textContent = "LÃ¼tfen tÃ¼m alanlarÄ± doldur.";
      return;
    }

    let list = JSON.parse(localStorage.getItem("sparkAdRequests") || "[]");
    list.push({
      id: Date.now(),
      user: currentUser.username,
      email: currentUser.email,
      brand,
      product,
      desc,
      status: "pending",
      adminMessage: "",
      date: new Date().toLocaleString("tr-TR")
    });
    localStorage.setItem("sparkAdRequests", JSON.stringify(list));

    statusEl.textContent = "Reklam isteÄŸin YÃ¶neticiye gÃ¶nderildi.";
    document.getElementById("reqBrand").value = "";
    document.getElementById("reqProduct").value = "";
    document.getElementById("reqDesc").value = "";
    renderNotifications();
  }

  function handleUserMessage() {
    const statusEl = document.getElementById("msgStatus");
    if (!currentUser || currentUser.role !== "user") {
      statusEl.textContent = "Ã–nce kullanÄ±cÄ± olarak giriÅŸ yapmalÄ±sÄ±n.";
      return;
    }

    const subject = document.getElementById("msgSubject").value.trim();
    const text = document.getElementById("msgText").value.trim();

    if (!subject || !text) {
      statusEl.textContent = "LÃ¼tfen konu ve mesajÄ± doldur.";
      return;
    }

    let list = JSON.parse(localStorage.getItem("sparkUserMessages") || "[]");
    list.push({
      id: Date.now(),
      fromUser: currentUser.username,
      email: currentUser.email,
      subject,
      text,
      date: new Date().toLocaleString("tr-TR")
    });
    localStorage.setItem("sparkUserMessages", JSON.stringify(list));

    statusEl.textContent = "MesajÄ±n YÃ¶neticiye iletildi.";
    document.getElementById("msgSubject").value = "";
    document.getElementById("msgText").value = "";
  }

  function renderAdminRequests() {
    const box = document.getElementById("adminRequests");
    if (!box) return;
    let list = JSON.parse(localStorage.getItem("sparkAdRequests") || "[]");
    if (!list.length) {
      box.innerHTML = "<div>HenÃ¼z reklam isteÄŸi yok.</div>";
      return;
    }
    box.innerHTML = list.map(req => {
      const statusClass =
        req.status === "approved"
          ? "status-approved"
          : req.status === "rejected"
          ? "status-rejected"
          : "status-pending";
      const statusText =
        req.status === "approved"
          ? "OnaylandÄ±"
          : req.status === "rejected"
          ? "Reddedildi"
          : "Beklemede";
      const approvedLocked = req.status === "approved";
      return `
        <div class="submission-item">
          <div class="submission-meta">
            ${req.date} â€“ <strong>${req.brand}</strong> (${req.product}) |
            KullanÄ±cÄ±: ${req.user} (${req.email})
            <span class="status-pill ${statusClass}">${statusText}</span>
          </div>
          <div>${req.desc}</div>
          ${req.adminMessage ? `<div>YÃ¶netici notu: ${req.adminMessage}</div>` : ""}
          <div class="admin-actions">
            <input type="text" id="adminNote-${req.id}" placeholder="KÄ±sa not (opsiyonel)" />
            <button class="btn-approve" onclick="updateRequestStatus(${req.id}, 'approved')" ${approvedLocked ? "disabled" : ""}>Onayla</button>
            <button class="btn-reject" onclick="updateRequestStatus(${req.id}, 'rejected')" ${approvedLocked ? "disabled" : ""}>Reddet</button>
          </div>
          ${approvedLocked ? `<div style="font-size:11px;color:#4ade80;margin-top:3px;">Bu istek onaylandÄ±, tekrar reddedilemez.</div>` : ""}
        </div>
      `;
    }).join("");
  }

  function updateRequestStatus(id, newStatus) {
    let list = JSON.parse(localStorage.getItem("sparkAdRequests") || "[]");
    const idx = list.findIndex(r => r.id === id);
    if (idx === -1) return;
    const req = list[idx];

    if (req.status === "approved" && newStatus === "rejected") {
      alert("Onaylanan bir istek reddedilemez.");
      return;
    }

    const noteInput = document.getElementById("adminNote-" + id);
    req.status = newStatus;
    req.adminMessage = noteInput ? noteInput.value.trim() : "";
    list[idx] = req;
    localStorage.setItem("sparkAdRequests", JSON.stringify(list));
    renderAdminRequests();
    if (currentUser && currentUser.role === "user") {
      renderNotifications();
    }
  }

  function renderAdminMessages() {
    const box = document.getElementById("adminMessages");
    if (!box) return;
    let list = JSON.parse(localStorage.getItem("sparkUserMessages") || "[]");
    if (!list.length) {
      box.innerHTML = "<div>HenÃ¼z mesaj yok.</div>";
      return;
    }
    box.innerHTML = list.map(m => `
      <div class="submission-item">
        <div class="submission-meta">
          ${m.date} â€“ <strong>${m.fromUser}</strong> (${m.email}) â€“ ${m.subject}
        </div>
        <div>${m.text}</div>
      </div>
    `).join("");
  }

  function renderAdminUsers() {
    const box = document.getElementById("adminUsers");
    if (!box) return;
    let users = getUsers();
    if (!users.length) {
      box.innerHTML = "<div>HenÃ¼z Ã¼ye yok.</div>";
      return;
    }
    box.innerHTML = users.map(u => `
      <div class="submission-item">
        <div class="submission-meta">
          KullanÄ±cÄ±: <strong>${u.username}</strong> (${u.email})
        </div>
        <div>Ãœyelik tarihi: ${u.createdAt || "-"}</div>
        <div>Son giriÅŸ: ${u.lastLogin || "-"}</div>
      </div>
    `).join("");
  }

  (function init() {
    const raw = localStorage.getItem("sparkCurrentUser");
    if (raw) {
      try { currentUser = JSON.parse(raw); } catch(e){ currentUser = null; }
    }
    updateHeader();
    if (currentUser) {
      document.getElementById("welcomeUser").textContent = currentUser.username || "";
      if (currentUser.role === "admin") {
        showScreen("admin");
        renderAdminRequests();
        renderAdminMessages();
        renderAdminUsers();
      } else {
        renderProfile();
        renderNotifications();
        showScreen("main");
      }
    } else {
      showScreen("info");
    }
  })();
</script>
</body>
</html>


