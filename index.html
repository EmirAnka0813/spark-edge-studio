<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>Spark Ad Studio</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --bg: #050816;
      --bg-soft: #0b1120;
      --bg-softer: #111827;
      --accent: #38bdf8;
      --accent-soft: rgba(56,189,248,0.18);
      --danger: #f97373;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --border: #1f2937;
      --radius: 10px;
      --shadow-soft: 0 18px 45px rgba(0,0,0,0.4);
      --font-sans: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    /* PLAN TEMALI RENKLER (paketler renk belirlemez; renkler kullanÄ±cÄ± seÃ§imine gÃ¶re uygulanÄ±r) */

    body.plan-free {}
    body.plan-starter {}
    body.plan-pro {}
    body.plan-influencer {}
    body.plan-admin {}

    /* NOTE: Paketleri ayÄ±rmak isterseniz paket etiketleri `tag` sÄ±nÄ±fÄ±yla gÃ¶sterilir; renkler ortak `--accent` deÄŸiÅŸkeninden gelir. */

    *{box-sizing:border-box;}

    body{
      margin:0;
      font-family:var(--font-sans);
      background:radial-gradient(circle at top,#111827 0,#020617 55%);
      color:var(--text);
      min-height:100vh;
      display:flex;
      justify-content:center;
      align-items:stretch;
    }

    #app{
      width:100%;
      max-width:1200px;
      margin:16px;
      background:linear-gradient(145deg,#020617 0%,#020715 40%,#020617 100%);
      border-radius:18px;
      box-shadow:var(--shadow-soft);
      border:1px solid #111827;
      display:flex;
      flex-direction:column;
      overflow:hidden;
    }

    /* TOPBAR */
    .topbar{
      display:flex;
      align-items:center;
      padding:12px 18px;
      border-bottom:1px solid #111827;
      background:radial-gradient(circle at 0 50%,#0b1120 0,#020617 55%);
      gap:10px;
      flex-wrap:wrap;
      position:relative;
    }



    .logo{
      width:36px;
      height:36px;
      border-radius:999px;
      background:#020617;
      background-image:url('sparkad-logo.png'); /* logonun adÄ± bu olsun */
      background-size:cover;
      background-position:center;
      box-shadow:0 0 18px var(--accent-soft);
      flex-shrink:0;
    }

    .top-left{
      display:flex;
      flex-direction:column;
      margin-right:auto;
    }

    .top-title{
      font-weight:650;
      letter-spacing:0.03em;
      font-size:18px;
    }

    .top-tagline{
      font-size:12px;
      color:var(--muted);
    }

    .top-nav{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
    }

    .nav-btn{
      border:1px solid transparent;
      background:transparent;
      color:var(--muted);
      padding:6px 10px;
      border-radius:999px;
      font-size:13px;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:4px;
      transition:0.2s all;
    }
    .nav-btn:hover{
      background:#020617;
      border-color:#1f2937;
      color:var(--text);
    }
    .nav-btn.primary{
      background:var(--accent-soft);
      border-color:var(--accent);
      color:#e0f2fe;
      font-weight:600;
    }
    .nav-btn.primary:hover{
      background:rgba(56,189,248,0.28);
      box-shadow:0 0 16px rgba(56,189,248,0.35);
    }
    .nav-btn.danger{
      border-color:#4b1b1b;
      color:#fecaca;
      background:rgba(220,38,38,0.08);
    }
    .nav-btn.danger:hover{
      background:rgba(220,38,38,0.16);
    }

    main{
      flex:1;
      padding:14px;
      overflow:auto;
    }

    .screen{display:none;width:100%;}
    .screen.active{display:block;}

    .card{
      background:radial-gradient(circle at top left,#020617 0,#020617 45%);
      border-radius:16px;
      padding:16px;
      border:1px solid #111827;
      box-shadow:0 12px 32px rgba(0,0,0,0.45);
    }

    .info-layout{
      display:grid;
      grid-template-columns:minmax(0,1.6fr) minmax(0,1.2fr);
      gap:16px;
      align-items:stretch;
    }

    .info-title{
      font-size:24px;
      font-weight:700;
      margin-bottom:6px;
    }

    .info-sub{
      font-size:14px;
      color:var(--muted);
      margin-bottom:12px;
    }

    .pill-row{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
      margin-bottom:12px;
    }
    .pill{
      font-size:11px;
      padding:4px 8px;
      border-radius:999px;
      background:#020617;
      border:1px solid #1f2937;
      color:var(--muted);
    }
    .pill.strong{
      border-color:var(--accent);
      color:#e0f2fe;
      background:#0b1120;
    }

    .btn-row{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px;}
    .btn-big{
      padding:9px 14px;
      border-radius:999px;
      border:1px solid transparent;
      font-size:14px;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:6px;
      font-weight:500;
      transition:0.2s;
    }
    .btn-big.primary{
      background:linear-gradient(135deg,var(--accent),var(--accent));
      color:#020617;
      box-shadow:0 18px 32px var(--accent-soft);
    }
    .btn-big.primary:hover{filter:brightness(1.05);transform:translateY(-1px);}

    /* Card accent top stripe to make accent color more visible */
    .card{position:relative}
    .card::before{content:'';display:block;height:6px;border-top-left-radius:16px;border-top-right-radius:16px;margin:-16px -16px 8px -16px;background:linear-gradient(90deg,var(--accent),transparent);}
    .btn-big.ghost{
      background:#020617;
      border-color:#1f2937;
      color:var(--muted);
    }

    .hint{font-size:11px;color:var(--muted);margin-top:6px;}

    /* AUTH */
    .auth-layout{max-width:640px;margin:0 auto;padding:18px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);box-shadow:inset 0 1px 0 rgba(255,255,255,0.02);}
    .auth-hero{display:flex;align-items:center;gap:12px;margin-bottom:12px;padding:10px;border-radius:10px;background:linear-gradient(180deg,rgba(56,189,248,0.06),rgba(255,255,255,0.01));border:1px solid rgba(56,189,248,0.06);}
    .auth-avatar{width:48px;height:48px;border-radius:999px;background:linear-gradient(45deg,var(--accent),#6ee7b7);box-shadow:0 6px 20px rgba(34,197,94,0.06) inset;display:flex;align-items:center;justify-content:center;font-weight:700;color:#020617}
    .auth-hero .hero-title{font-weight:700;font-size:15px;background:linear-gradient(90deg,#ffffff,#e0f2fe,#fef3c7);-webkit-background-clip:text;background-clip:text;color:transparent;background-size:200% 100%;animation:heroShine 3s linear infinite}
    .auth-hero .hero-sub{font-size:12px;color:var(--muted)}
    @keyframes heroShine{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}

    .tabs{display:flex;gap:6px;margin-bottom:10px;}
    .tab-btn{
      flex:1;
      padding:7px 10px;
      border-radius:999px;
      border:1px solid #1f2937;
      background:#020617;
      font-size:13px;
      color:var(--muted);
      cursor:pointer;
      transition:0.2s;
    }
    .tab-btn.active{
      background:var(--accent-soft);
      border-color:var(--accent);
      color:#e0f2fe;
      font-weight:600;
    }

    .auth-layout input{padding:11px 12px;border-radius:10px;font-size:14px;border:1px solid #111827;background:#020617}
    .auth-layout input:focus{box-shadow:0 0 0 4px rgba(56,189,248,0.06);border-color:var(--accent)}
    .auth-layout .form-actions{justify-content:space-between}
    .remember-row{display:flex;align-items:center;gap:8px;font-size:13px;color:var(--muted)}
    .btn-sm.primary{padding:8px 16px;border-radius:999px;transition:transform .18s,box-shadow .18s}
    .btn-sm.primary:active{transform:translateY(1px);}

    /* Welcome overlay to create immersive login transition */
    .welcome-overlay{position:fixed;left:0;top:0;width:100%;height:100%;display:none;align-items:center;justify-content:center;z-index:60;pointer-events:none}
    .welcome-overlay.show{display:flex;pointer-events:auto}
    .welcome-card{background:linear-gradient(135deg,var(--accent),rgba(255,255,255,0.08));padding:18px 24px;border-radius:12px;color:#020617;font-weight:700;letter-spacing:0.02em;box-shadow:0 20px 40px rgba(0,0,0,0.5);transform:translateY(20px) scale(0.98);opacity:0;transition:transform .36s ease,opacity .36s}
    .welcome-overlay.show .welcome-card{transform:translateY(0) scale(1);opacity:1}

    #app.immersive{transform:scale(1.01);transition:transform .36s}
    #app{transition:transform .36s}

    .card.pulse{animation:pulseCard .9s ease}
    @keyframes pulseCard{0%{transform:translateY(0);box-shadow:0 12px 32px rgba(0,0,0,0.45)}20%{transform:translateY(-6px)}100%{transform:translateY(0)}}
    

    .form-grid{display:grid;gap:8px;margin-top:8px;}
    label{
      font-size:12px;
      color:var(--muted);
      display:block;
      margin-bottom:2px;
    }

    input,textarea,select{
      width:100%;
      border-radius:8px;
      border:1px solid #1f2937;
      background:#020617;
      color:var(--text);
      padding:7px 9px;
      font-size:13px;
      outline:none;
      transition:.15s border-color,.15s box-shadow,.15s background;
    }
    input:focus,textarea:focus,select:focus{
      border-color:var(--accent);
      box-shadow:0 0 0 1px rgba(56,189,248,0.25);
      background:#020819;
    }
    textarea{min-height:80px;resize:vertical;}

    .form-actions{
      display:flex;
      justify-content:flex-end;
      gap:8px;
      margin-top:8px;
      flex-wrap:wrap;
    }
    .btn-sm{
      padding:6px 11px;
      border-radius:999px;
      border:1px solid #1f2937;
      background:#020617;
      font-size:12px;
      color:var(--muted);
      cursor:pointer;
      transition:0.2s;
    }
    .btn-sm.primary{
      border-color:var(--accent);
      background:var(--accent-soft);
      color:#e0f2fe;
    }

    .section-title{font-size:15px;font-weight:600;margin-bottom:6px;}
    .section-sub{font-size:12px;color:var(--muted);margin-bottom:8px;}

    .columns-2{
      display:grid;
      grid-template-columns:minmax(0,1.5fr) minmax(0,1.2fr);
      gap:12px;
    }

    .tag{
      font-size:10px;
      padding:2px 6px;
      border-radius:999px;
      border:1px solid var(--accent);
      background:var(--accent-soft);
      color:#e0f2fe;
    }
    /* Paketlere baÄŸlÄ± Ã¶zel renkler kaldÄ±rÄ±ldÄ±; her paket aynÄ± accent rengini kullanÄ±r */
    .tag.standard{}
    .tag.pro{}
    .tag.influencer{}
    .tag.admin{}

    .user-inline{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:8px;
      margin-bottom:8px;
      flex-wrap:wrap;
    }

    /* CHAT */
    .chat-box{
      border-radius:12px;
      border:1px solid #1f2937;
      background:#020617;
      display:flex;
      flex-direction:column;
      height:250px;
      overflow:hidden;
    }
    .chat-log{
      flex:1;
      padding:8px;
      overflow-y:auto;
      font-size:12px;
    }
    .chat-line{
      margin-bottom:6px;
      display:flex;
      gap:6px;
    }
    .chat-line.me{justify-content:flex-end;}
    .chat-bubble{
      max-width:80%;
      border-radius:12px;
      border-bottom-left-radius:4px;
      padding:6px 9px;
      border:1px solid #1f2937;
      background:#020617;
    }
    .chat-line.me .chat-bubble{
      background:var(--accent-soft);
      border-color:var(--accent);
    }
    .chat-line.ai .chat-bubble{
      background:rgba(15,23,42,0.96);
    }
    .chat-meta{font-size:10px;color:var(--muted);margin-bottom:2px;}
    .chat-input-row{
      display:flex;
      border-top:1px solid #111827;
    }
    .chat-input-row input{
      border-radius:0;
      border:none;
      border-right:1px solid #111827;
    }
    .chat-input-row button{
      border:none;
      background:var(--accent-soft);
      color:#e0f2fe;
      padding:0 14px;
      font-size:12px;
      cursor:pointer;
    }

    /* LISTS */
    .list{max-height:240px;overflow-y:auto;font-size:12px;}
    .list-item{
      padding:7px 8px;
      border-radius:9px;
      border:1px solid #111827;
      background:rgba(15,23,42,0.9);
      margin-bottom:6px;
    }
    .label-row{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:6px;
      margin-bottom:3px;
    }
    .list-meta{font-size:10px;color:var(--muted);}
    .pill-small{
      font-size:9px;
      padding:1px 5px;
      border-radius:999px;
      border:1px solid #4b5563;
      color:#9ca3af;
    }
    .pill-small.green{border-color:var(--accent);color:#e0f2fe;}
    .pill-small.blue{border-color:var(--accent);color:#e0f2fe;}
    .pill-small.orange{border-color:var(--accent);color:#e0f2fe;}
    .pill-small.gold{border-color:var(--accent);color:#e0f2fe;}
    .pill-small.gray{border-color:#4b5563;color:#9ca3af;}

    .admin-actions{display:flex;gap:6px;margin-top:4px;flex-wrap:wrap;}
    .admin-actions button{
      font-size:11px;
      padding:3px 7px;
      border-radius:999px;
      border:1px solid #1f2937;
      background:#020617;
      color:#9ca3af;
      cursor:pointer;
    }

    .pricing-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(180px,1fr));
      gap:10px;
    }
    .price-card{
      border-radius:14px;
      padding:11px;
      border:1px solid #1f2937;
      background:#020617;
      display:flex;
      flex-direction:column;
      justify-content:space-between;
      box-shadow:inset 0 0 0 1px rgba(0,0,0,0.2);
    }
    .price-card .price-name{display:flex;align-items:center;gap:8px}
    .price-card .price-name:before{content:'';width:8px;height:8px;border-radius:3px;background:var(--accent);display:inline-block;margin-right:6px}
    .price-name{font-size:14px;font-weight:600;margin-bottom:3px;}
    .price-tag{font-size:11px;color:var(--muted);margin-bottom:6px;}
    .price-value{font-size:18px;font-weight:700;margin-bottom:2px;}
    .price-note{font-size:10px;color:var(--muted);margin-bottom:6px;}

    .avatar-circle{
      width:52px;
      height:52px;
      border-radius:999px;
      background:radial-gradient(circle at 30% 0,var(--accent),rgba(255,255,255,0.08));
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:700;
      font-size:20px;
      color:#020617;
      box-shadow:inset 0 -6px 24px var(--accent-soft);
    }
    .profile-row{
      display:flex;
      gap:12px;
      align-items:center;
      margin-bottom:10px;
      position:relative;
      z-index:2;
    }

    /* PROFÄ°L KARTI ANÄ°MASYONLU Ã‡ERÃ‡EVE */

    #profile-card{
      position:relative;
      overflow:hidden;
      border-radius:18px;
      z-index:1;
    }
    #profile-card::before{
      content:"";
      position:absolute;
      inset:-2px;
      background:linear-gradient(130deg,var(--accent),rgba(255,255,255,0.04));
      opacity:0;
      z-index:-1;
    }
    #profile-card.profile-starter::before{opacity:0.7;}
    #profile-card.profile-pro::before{opacity:0.9;}
    #profile-card.profile-influencer::before{opacity:1;}
    @keyframes spin-gold{from{transform:rotate(0deg);}

    @keyframes spin-gold{
      from{transform:rotate(0deg);}
      to{transform:rotate(360deg);}
    }

    #profile-card > *{
      position:relative;
      z-index:2;
    }

    @media(max-width:900px){
      #app{margin:8px;}
      main{padding:10px;}
      .info-layout,.columns-2{
        grid-template-columns:minmax(0,1fr);
      }
    }
  </style>
</head>
<body>
  <div id="app">
    <header class="topbar">
      <div class="logo"></div>
      <div class="top-left">
        <div class="top-title">Spark Ad Studio</div>
        <div class="top-tagline">KulÃ¼pler ve markalar iÃ§in mini reklam stÃ¼dyosu</div>
      </div>
      <nav class="top-nav">
        <button class="nav-btn" data-nav="info" id="nav-info">Bilgi</button>
        <button class="nav-btn" data-nav="home" id="nav-home">Ana Sayfa</button>
        <button class="nav-btn" data-nav="studio" id="nav-studio" style="display:none;">StÃ¼dyo</button>
        <button class="nav-btn" data-nav="community" id="nav-community" style="display:none;">Topluluk</button>
        <button class="nav-btn" data-nav="assistant" id="nav-assistant" style="display:none;">Asistan</button>
        <button class="nav-btn" data-nav="pricing" id="nav-pricing">FiyatlandÄ±rma</button>
        <button class="nav-btn" data-nav="profile" id="nav-profile" style="display:none;">Profil</button>
        <button class="nav-btn" data-nav="admin" id="nav-admin" style="display:none;">Admin</button>
        <button class="nav-btn" data-nav="settings" id="nav-settings" style="display:none;">Ayarlar</button> 
        <button class="nav-btn danger" id="btn-logout" style="display:none;">Ã‡Ä±kÄ±ÅŸ</button>


        <button class="nav-btn primary" id="btn-auth">Ãœye Ol / GiriÅŸ Yap</button>
      </nav>
    </header>

    <main>
      <!-- BÄ°LGÄ° EKRANI -->
      <section id="screen-info" class="screen active">
        <div class="info-layout">
          <div class="card">
            <div class="badge" style="display:inline-flex;gap:4px;padding:2px 8px;border-radius:999px;border:1px solid #1f2937;font-size:10px;color:var(--muted);">
              <span style="width:6px;height:6px;border-radius:999px;background:#22c55e;"></span>
              7. sÄ±nÄ±ftan kulÃ¼plere kadar mini ajans fikri
            </div>
            <h1 class="info-title">Spark Ad Studio ile kulÃ¼bÃ¼n reklamlarÄ±nÄ± hÄ±zlÄ±ca planla.</h1>
            <p class="info-sub">
              KÄ±sa, akÄ±lda kalÄ±cÄ± videolar iÃ§in sahne akÄ±ÅŸÄ±nÄ±, sloganÄ± ve metni birlikte dÃ¼ÅŸÃ¼nmen iÃ§in
              tasarlanmÄ±ÅŸ basit bir panel. KulÃ¼bÃ¼nÃ¼n adÄ±, kampanya konusu ve hedef kitleni yazman yeterli.
            </p>
            <div class="pill-row">
              <span class="pill strong">KulÃ¼pler â€¢ Okullar â€¢ Markalar</span>
              <span class="pill">Reklam isteÄŸi formu</span>
              <span class="pill">Yapay zekÃ¢ asistanÄ±</span>
              <span class="pill">Paketli abonelik</span>
            </div>
            <div class="btn-row">
              <button class="btn-big primary" id="btn-info-start">Hemen BaÅŸla</button>
              <button class="btn-big ghost" id="btn-info-pricing">Paketlere Bak</button>
            </div>

          </div>
          <div class="card">
            <div class="section-title">Ã–rnek yÄ±llÄ±k kulÃ¼p Ã¶zeti</div>
            <div class="section-sub">
              Spark Ad Studio, girdiÄŸin verilerle â€œstoryâ€ tadÄ±nda yÄ±llÄ±k Ã¶zet videolar hazÄ±rlamana yardÄ±m eder.
            </div>
            <ul class="hint" style="list-style:disc;padding-left:18px;">
              <li>KatÄ±ldÄ±ÄŸÄ± yarÄ±ÅŸma sayÄ±sÄ±</li>
              <li>Toplam kilometre (gidiÅŸâ€“dÃ¶nÃ¼ÅŸ)</li>
              <li>KazanÄ±lan madalyalar</li>
              <li>Sosyal medya etkileÅŸim artÄ±ÅŸÄ±</li>
            </ul>
          </div>
        </div>
      </section>

      <!-- ANA SAYFA -->
      <section id="screen-home" class="screen">
        <div class="card">
          <div class="section-title" id="home-title">Spark Ad Studio</div>
          <div class="section-sub" id="home-sub">
            GiriÅŸ yaptÄ±ktan sonra paket durumun ve aktivitelerin Ã¶zeti burada gÃ¶rÃ¼necek.
          </div>
          <ul id="home-summary" class="hint" style="list-style:disc;padding-left:18px;"></ul>
        </div>
      </section>

      <!-- AUTH -->
      <section id="screen-auth" class="screen">
        <div class="card auth-layout">
          <div class="section-title">HesabÄ±na giriÅŸ yap</div>
          <div class="section-sub">
            StÃ¼dyoyu kullanmak iÃ§in giriÅŸ yap veya yeni hesap oluÅŸtur.
          </div>

          <div class="auth-hero" id="auth-hero" aria-hidden="true">
            <div class="auth-avatar">SA</div>
            <div>
              <div class="hero-title">HÄ±zlÄ±, basit ve eÄŸlenceli</div>
              <div class="hero-sub">HesabÄ±na giriÅŸ yaparak fikir Ã¼retimine hemen baÅŸla.</div>
            </div>
          </div>

          <div class="tabs">
            <button class="tab-btn active" id="tab-login">GiriÅŸ Yap</button>
            <button class="tab-btn" id="tab-register">Ãœye Ol</button>
          </div>

          <div id="auth-login">
            <div class="form-grid">
              <div>
                <label for="login-email">E-posta</label>
                <input id="login-email" type="email" placeholder="ornek@kulubun.com" />
              </div>
              <div>
                <label for="login-pass">Åifre</label>
                <input id="login-pass" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" />
              </div>
            </div>
            <div class="form-grid" style="margin-top:8px;">
              <label class="remember-row"><input type="checkbox" id="remember-me" /> Beni hatÄ±rla</label>
            </div>
            <div class="form-actions">
              <button class="btn-sm" id="btn-forgot">Åifremi unuttum</button>
              <button class="btn-sm primary" id="btn-login">GiriÅŸ Yap</button>
            </div>
            <p class="hint" id="auth-message"></p>
          </div>

          <div id="auth-register" style="display:none;">
            <div class="form-grid">
              <div>
                <label for="reg-name">Ad Soyad</label>
                <input id="reg-name" placeholder="Emir Anka" />
              </div>
              <div>
                <label for="reg-email">E-posta</label>
                <input id="reg-email" type="email" placeholder="ornek@kulubun.com" />
              </div>
              <div>
                <label for="reg-pass">Åifre</label>
                <input id="reg-pass" type="password" placeholder="En az 6 karakter" />
              </div>
            </div>
            <div class="form-actions">
              <button class="btn-sm" id="btn-to-login">Zaten hesabÄ±m var</button>
              <button class="btn-sm primary" id="btn-register">Ãœye Ol ve GiriÅŸ Yap</button>
            </div>
            <p class="hint">
              Yeni hesaplar varsayÄ±lan olarak <b>Starter</b> paketi ile aÃ§Ä±lÄ±r.
            </p>
          </div>
        </div>
      </section>

      <!-- KULLANICI STÃœDYO -->
      <section id="screen-user" class="screen">
        <div class="columns-2">
          <div class="card">
            <div class="user-inline">
              <div>
                <div class="section-title" id="user-welcome">HoÅŸ geldin!</div>
                <div class="section-sub">
                  KulÃ¼bÃ¼n iÃ§in reklam isteÄŸi bÄ±rak; onaylandÄ±ktan sonra bu fikirleri videoya dÃ¶nÃ¼ÅŸtÃ¼relim.
                </div>
              </div>
              <span class="tag standard" id="user-plan-badge">Starter Ãœye</span>
            </div>
            <div class="section-title">Reklam Ä°steÄŸi OluÅŸtur</div>
            <div class="section-sub">
              KulÃ¼p / marka adÄ±, Ã¼rÃ¼n / kampanya ve kÄ±sa aÃ§Ä±klama gir. Ä°stek onay bekleyen listesine dÃ¼ÅŸer.
            </div>
            <div class="form-grid">
              <div>
                <label for="req-brand">Marka / KulÃ¼p AdÄ±</label>
                <input id="req-brand" placeholder="IÅŸÄ±kkent OkÃ§uluk KulÃ¼bÃ¼" />
              </div>
              <div>
                <label for="req-product">ÃœrÃ¼n / Kampanya</label>
                <input id="req-product" placeholder="Yeni sezon forma tanÄ±tÄ±mÄ±" />
              </div>
              <div>
                <label for="req-details">KÄ±sa AÃ§Ä±klama</label>
                <textarea id="req-details" placeholder="Hedef kitle, ton, sÃ¼re vb."></textarea>
              </div>
            </div>
            <div class="form-actions">
              <button class="btn-sm primary" id="btn-send-request">Ä°stek GÃ¶nder</button>
            </div>
            <p class="hint" id="req-hint"></p>
          </div>

          <div class="card">
            <div class="section-title">Spark AI Asistan</div>
            <div class="section-sub">
              KulÃ¼bÃ¼nle ilgili reklam fikirleri sor. Ã–rn:
              <em>â€œOkÃ§uluk kulÃ¼bÃ¼m iÃ§in 15 sn Reels fikri Ã¶ner.â€</em>
            </div>
            <div class="chat-box">
              <div id="chat-log" class="chat-log"></div>
              <div class="chat-input-row">
                <input id="assistant-input" placeholder="Sorunu yaz..." />
                <button id="assistant-send">GÃ¶nder</button>
              </div>
            </div>
          </div>
        </div>

        <div class="card" style="margin-top:10px;">
          <div class="section-title">Paketine gÃ¶re ayrÄ±calÄ±klarÄ±n</div>
          <ul id="user-perks" class="hint" style="list-style:disc;padding-left:18px;"></ul>
        </div>
      </section>



      <!-- YÃ–NETÄ°CÄ° PANELÄ° -->
      <section id="screen-admin" class="screen">
        <div class="card">
          <div class="section-title">YÃ¶netici Paneli</div>
          <div class="section-sub">Ãœyeler, istekler, mesajlar, paketler ve topluluk yÃ¶netimi.</div>
          <div style="margin-top:10px;display:flex;gap:6px;flex-wrap:wrap;" id="admin-topnav">
            <button class="btn-sm" id="admin-tab-users">Ãœyeler</button>
            <button class="btn-sm" id="admin-tab-requests">Ä°stekler</button>
            <button class="btn-sm" id="admin-tab-community">Topluluk</button>
            <button class="btn-sm" id="admin-tab-messages">Mesajlar</button>
            <button class="btn-sm" id="admin-tab-pricing">Paketler</button>
            <button class="btn-sm" id="admin-tab-logs">Loglar</button>
          </div>
        </div>

        <div class="card" style="margin-top:10px;">
          <div id="admin-users" class="admin-section"></div>
          <div id="admin-requests" class="admin-section" style="display:none"></div>
          <div id="admin-community" class="admin-section" style="display:none"></div>
          <div id="admin-messages" class="admin-section" style="display:none"></div>
          <div id="admin-pricing" class="admin-section" style="display:none"></div>
          <div id="admin-logs" class="admin-section" style="display:none"></div>
        </div>
      </section> 

      <!-- PROFÄ°L -->
      <section id="screen-profile" class="screen">
        <div class="card" id="profile-card">
          <div class="profile-row">
            <div class="avatar-circle" id="profile-avatar">SA</div>
            <div>
              <div class="section-title" id="profile-name">KullanÄ±cÄ±</div>
              <div class="section-sub" id="profile-email">mail@ornek.com</div>
              <span class="tag standard" id="profile-plan">Starter Ãœye</span>
              <div id="profile-badges" style="margin-top:8px;display:flex;gap:6px;flex-wrap:wrap;"></div>
              <div style="margin-top:8px;"><button class="btn-sm" id="btn-sim-badges">Rozetleri Test Et</button></div>
            </div>
          </div>
          <div class="columns-2">
            <div>
              <div class="section-title">Profilini DÃ¼zenle</div>
              <div class="section-sub">
                GÃ¶rÃ¼nen ismini deÄŸiÅŸtir, asistan sana bu isimle hitap eder.
              </div>
              <div class="form-grid">
                <div>
                  <label for="profile-name-input">Yeni gÃ¶rÃ¼nen ad</label>
                  <input id="profile-name-input" placeholder="Yeni ad..." />
                </div>
              </div>
              <div class="form-actions">
                <button class="btn-sm primary" id="btn-save-profile">Kaydet</button>
              </div>
            </div>
            <div>
              <div class="section-title">Kendi Grubunu Kur (SimÃ¼lasyon)</div>
              <div class="section-sub">
                Ã–rn: â€œMedya Ekibiâ€, sistem kayÄ±tlÄ± kullanÄ±cÄ±lardan sana â€œekip olabilecekâ€ Ã¶rnekler gÃ¶sterir.
              </div>
              <div class="form-grid">
                <div>
                  <label for="group-name-input">Grup AdÄ±</label>
                  <input id="group-name-input" placeholder="IÅŸÄ±kkent Creative Squad" />
                </div>
              </div>
              <div class="form-actions">
                <button class="btn-sm primary" id="btn-create-group">Ã–nerileri GÃ¶ster</button>
              </div>
              <ul id="group-suggestions" class="hint" style="list-style:disc;padding-left:18px;margin-top:8px;"></ul>
            </div>
          </div>
        </div>
      </section>

      <!-- FÄ°YATLANDIRMA (KULLANICI) -->
      <section id="screen-pricing" class="screen">
        <div class="card">
          <div class="section-title">Paketler ve Kredi Paketleri</div>
          <div class="section-sub">
            Bu demo sistemde gerÃ§ek Ã¶deme yok. Butona tÄ±klayÄ±nca paketini deÄŸiÅŸtiriyormuÅŸ gibi davranÄ±r ve
            paneldeki renk / rozetler gÃ¼ncellenir.
          </div>
          <div id="user-pricing" class="pricing-grid"></div>
        </div>
      </section>

      <!-- TOPLULUK -->
      <section id="screen-community" class="screen">
        <div class="card">
          <div class="section-title">Topluluk MesajlarÄ±</div>
          <div class="section-sub">
            Duyuru, fikir veya proje linki paylaÅŸ. MesajlarÄ±n sadece bu tarayÄ±cÄ±da saklanÄ±r (demo).
          </div>
          <div class="form-grid">
            <div>
              <label for="community-text">MesajÄ±n</label>
              <textarea id="community-text" placeholder="BugÃ¼n ÅŸu fikri denedik..."></textarea>
            </div>
          </div>
          <div class="form-actions">
            <button class="btn-sm primary" id="btn-community-post">Mesaj GÃ¶nder</button>
          </div>
          <p class="hint" id="community-hint"></p>
          <div id="community-list" class="list" style="margin-top:8px;"></div>
        </div>
      </section>

      <!-- ASÄ°STAN TAM EKRAN -->
      <section id="screen-assistant" class="screen">
        <div class="card">
          <div class="section-title">Spark AI Asistan (Tam Alan)</div>
          <div class="section-sub">
            AynÄ± asistan, sadece daha geniÅŸ alan. KulÃ¼bÃ¼n, forma satÄ±ÅŸÄ± veya kampanya hakkÄ±nda sorular sor.
          </div>
          <div class="chat-box">
            <div id="chat-log-2" class="chat-log"></div>
            <div class="chat-input-row">
              <input id="assistant-input-2" placeholder="Reklam sorunu buraya yaz..." />
              <button id="assistant-send-2">GÃ¶nder</button>
            </div>
          </div>
        </div>
      </section>

      <!-- AYARLAR -->
      <section id="screen-settings" class="screen">
        <div class="card">
          <div class="section-title">Ayarlar</div>
          <div class="section-sub">
            Tema, abonelik paketine gÃ¶re otomatik olarak altÄ±n / mor / mavi tona geÃ§er. Bu bÃ¶lÃ¼m demo amaÃ§lÄ±dÄ±r.
          </div>
          <p class="hint" id="settings-hint">
            Starter â†’ mavi, Spark Pro â†’ mor, Influencer â†’ gold animasyonlu Ã§erÃ§eve ile gÃ¶rÃ¼nÃ¼r.
          </p>
        </div>
      </section>
    </main>

    <div id="welcome-overlay" class="welcome-overlay" aria-hidden="true">
      <div class="welcome-card">HoÅŸ geldin, <span id="welcome-name"></span>!</div>
    </div>

  </div>

  <script>
    const STORAGE_KEY = "spark_ad_studio_local_db_v2";

    const DEFAULT_DB = {
      users: [{ id:'u_admin', name:'Admin', email:'admin@sparkad.studio', pass:'spark123', plan:'admin', role:'admin', credits:0, badges:[] }],
      requests: [],
      messages: [],
      communityPosts: [],
      adminLogs: [],
      plans: [
        {
          id:"starter",
          name:"Starter",
          type:"subscription",
          priceTl:250,
          perks:"AylÄ±k 1â€“2 kÄ±sa video, temel AI, standart hÄ±z",
          color:"standard"
        },
        {
          id:"pro",
          name:"Spark Pro",
          type:"subscription",
          priceTl:1100,
          perks:"AylÄ±k 4â€“5 video, morâ€“mavi AI fikirleri, Ã¶ncelikli teslim",
          color:"pro"
        },
        {
          id:"influencer",
          name:"Influencer",
          type:"subscription",
          priceTl:1600,
          perks:"Gold premium gÃ¶rÃ¼nÃ¼m, en detaylÄ± AI ve Ã¶ne Ã§Ä±kan isim rengi",
          color:"influencer"
        },
        {
          id:"credits10",
          name:"10 Kredi Paketi",
          type:"credits",
          priceTl:490,
          perks:"10 reklama kadar brif Ã¼retimi",
          color:"standard"
        },
        {
          id:"credits25",
          name:"25 Kredi Paketi",
          type:"credits",
          priceTl:990,
          perks:"25 reklama kadar brif Ã¼retimi",
          color:"pro"
        }
      ]
    };

    function loadDB(){
      try{
        const raw = localStorage.getItem(STORAGE_KEY);
        if(!raw) return structuredClone(DEFAULT_DB);
        const parsed = JSON.parse(raw);
        return Object.assign(structuredClone(DEFAULT_DB), parsed);
      }catch(e){
        return structuredClone(DEFAULT_DB);
      }
    }

    const DB = loadDB();
    // Demo helper: ensure an admin user exists so admin login works after refactor
    try{
      if(!DB.users.find(u=>u && (u.role==='admin' || (u.email && u.email.toLowerCase()==='admin@sparkad.studio')))){
        DB.users.unshift({ id:'u_admin', name:'Admin', email:'admin@sparkad.studio', pass:'spark123', plan:'admin', role:'admin', credits:0, badges:[] });
        console.log('[seed] Admin user created: admin@sparkad.studio');
        saveDB();
      }else{
        const au = DB.users.find(u=>u && u.email && u.email.toLowerCase()==='admin@sparkad.studio');
        if(au) au.role='admin';
      }
    }catch(e){ console.warn('[seed] ensure admin failed', e); }

    function saveDB(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(DB)); }

    let currentUser = null;

    const screens = {
      info:document.getElementById("screen-info"),
      home:document.getElementById("screen-home"),
      auth:document.getElementById("screen-auth"),
      user:document.getElementById("screen-user"),
      admin:document.getElementById("screen-admin"),
      profile:document.getElementById("screen-profile"),
      pricing:document.getElementById("screen-pricing"),
      community:document.getElementById("screen-community"),
      assistant:document.getElementById("screen-assistant"),
      settings:document.getElementById("screen-settings")
    }; 



    const btnAuth = document.getElementById("btn-auth");
    const btnLogout = document.getElementById("btn-logout");
    const navInfo = document.getElementById("nav-info");
    const navHome = document.getElementById("nav-home");
    const navStudio = document.getElementById("nav-studio");
    const navCommunity = document.getElementById("nav-community");
    const navAssistant = document.getElementById("nav-assistant");
    const navPricing = document.getElementById("nav-pricing");
    const navProfile = document.getElementById("nav-profile");
    const navAdmin = document.getElementById("nav-admin");
    const navSettings = document.getElementById("nav-settings");

    function updateTopbar(){
      console.log('[ui] updateTopbar called, currentUser=', currentUser);
      if(currentUser && currentUser.role && String(currentUser.role).toLowerCase()==='admin'){
        // Admin: keep header minimal and show only admin button + logout
        btnAuth.style.display="none";
        btnLogout.style.display="inline-flex";
        navStudio.style.display="none";
        navCommunity.style.display="none";
        navAssistant.style.display="none";
        navProfile.style.display="none";
        navSettings.style.display="none";
        navAdmin.style.display="inline-flex";
      }else if(currentUser){
        btnAuth.style.display="none";
        btnLogout.style.display="inline-flex";
        navStudio.style.display="inline-flex";
        navCommunity.style.display="inline-flex";
        navAssistant.style.display="inline-flex";
        navProfile.style.display="inline-flex";
        navSettings.style.display="inline-flex";
        navAdmin.style.display="none";
      }else{
        btnAuth.style.display="inline-flex";
        btnLogout.style.display="none";
        navStudio.style.display="none";
        navCommunity.style.display="none";
        navAssistant.style.display="none";
        navProfile.style.display="none";
        navSettings.style.display="none";
        navAdmin.style.display="none";
      }
    }





    function findUserByEmail(email){
      return DB.users.find(u => u.email.toLowerCase() === email.toLowerCase());
    }



    function applyPlanTheme(plan){
      const b=document.body;
      b.classList.remove("plan-starter","plan-pro","plan-influencer","plan-admin","plan-free");
      const THEME_MAP = { free:'#38bdf8', starter:'#38bdf8', pro:'#a855f7', influencer:'#fbbf24', admin:'#22c55e' };
      const color = THEME_MAP[plan] || THEME_MAP['free'];

      if(plan==="starter") b.classList.add("plan-starter");
      else if(plan==="pro") b.classList.add("plan-pro");
      else if(plan==="influencer") b.classList.add("plan-influencer");
      else if(plan==="admin") b.classList.add("plan-admin");
      else b.classList.add("plan-free");

      // apply accent colors
      try{
        document.documentElement.style.setProperty('--accent', color);
        const c = (color||'#38bdf8').replace('#','');
        const r = parseInt(c.substring(0,2),16);
        const g = parseInt(c.substring(2,4),16);
        const bCol = parseInt(c.substring(4,6),16);
        document.documentElement.style.setProperty('--accent-soft', `rgba(${r},${g},${bCol},0.18)`);
      }catch(e){}
    }





    const TAB_LOGIN = document.getElementById("tab-login");
    const TAB_REGISTER = document.getElementById("tab-register");
    const VIEW_LOGIN = document.getElementById("auth-login");
    const VIEW_REGISTER = document.getElementById("auth-register");
    const authMsg = document.getElementById("auth-message");

    TAB_LOGIN.addEventListener("click",()=>{
      TAB_LOGIN.classList.add("active");
      TAB_REGISTER.classList.remove("active");
      VIEW_LOGIN.style.display="";
      VIEW_REGISTER.style.display="none";
      authMsg.textContent="";
    });
    TAB_REGISTER.addEventListener("click",()=>{
      TAB_REGISTER.classList.add("active");
      TAB_LOGIN.classList.remove("active");
      VIEW_REGISTER.style.display="";
      VIEW_LOGIN.style.display="none";
      authMsg.textContent="";
    });
    document.getElementById("btn-to-login").addEventListener("click",()=>TAB_LOGIN.click());

    const loginEmail = document.getElementById("login-email");
    const loginPass = document.getElementById("login-pass");
    const rememberMe = document.getElementById("remember-me");
    const regName = document.getElementById("reg-name");
    const regEmail = document.getElementById("reg-email");
    const regPass = document.getElementById("reg-pass");
    const btnLogin = document.getElementById("btn-login");
    const btnRegister = document.getElementById("btn-register");

    function registerUser(){
      const name = regName.value.trim();
      const email = regEmail.value.trim();
      const pass = regPass.value.trim();
      if(!name || !email || !pass){
        authMsg.textContent="LÃ¼tfen tÃ¼m alanlarÄ± doldur.";
        return;
      }
      if(pass.length<6){
        authMsg.textContent="Åifre en az 6 karakter olmalÄ±.";
        return;
      }
      if(findUserByEmail(email)){
        authMsg.textContent="Bu e-posta ile bir hesap zaten var.";
        return;
      }
      DB.users.push({
        id:"u_"+Date.now(),
        name,
        email,
        pass,
        plan:"starter",
        credits:0,
        badges:[],
        role:'user'
      });
      saveDB();
      authMsg.textContent="KayÄ±t baÅŸarÄ±lÄ±, giriÅŸ yapÄ±lÄ±yor...";
      loginEmail.value=email;
      loginPass.value=pass;
      setTimeout(()=>loginUser(),300);
    }

    // Show a small immersive welcome card when user logs in
    function showWelcome(name){
      const overlay = document.getElementById('welcome-overlay');
      const nm = document.getElementById('welcome-name');
      nm.textContent = name;
      overlay.classList.add('show');
      overlay.setAttribute('aria-hidden','false');
      document.getElementById('app').classList.add('immersive');
      setTimeout(()=>{
        overlay.classList.remove('show');
        overlay.setAttribute('aria-hidden','true');
        document.getElementById('app').classList.remove('immersive');
      },1200);
    }

    // Rozet kontrolÃ¼: eÄŸer kullanÄ±cÄ±nÄ±n en son 3 isteÄŸi ardÄ±ÅŸÄ±k olarak onaylandÄ±ysa rozet ver
    function awardBadgesForUser(email){
      if(!email) return;
      const u = DB.users.find(x=>x.email===email);
      if(!u) return;
      const userReqs = DB.requests.filter(r=>r.userEmail===email).sort((a,b)=>b.createdAt.localeCompare(a.createdAt));
      if(userReqs.length<3) return;
      const recent3 = userReqs.slice(0,3);
      if(recent3.every(r=>r.status==='approved')){
        u.badges = u.badges||[];
        if(!u.badges.includes('ÅimÅŸek Fikir Rozeti')){
          u.badges.push('ÅimÅŸek Fikir Rozeti');
          saveDB();
          // show small notice
          if(currentUser && currentUser.email===email){
            const reqHintLocal = document.getElementById('req-hint');
            if(reqHintLocal) reqHintLocal.textContent = 'Tebrikler! Yeni rozet: ÅimÅŸek Fikir Rozeti';
          }
        }
      }
    }

    // Update profile badges area
    function renderProfile(){
      if(!currentUser) return;
      const meta=getPlanMeta(currentUser.plan);
      profileName.textContent=currentUser.name;
      profileEmail.textContent=currentUser.email;
      profilePlan.textContent=meta.label;
      profilePlan.className="tag "+(meta.color||"standard");

      profileCard.classList.remove("profile-starter","profile-pro","profile-influencer");
      if(currentUser.plan==="starter"){
        profileCard.classList.add("profile-starter");
      }else if(currentUser.plan==="pro"){
        profileCard.classList.add("profile-pro");
      }else if(currentUser.plan==="influencer"){
        profileCard.classList.add("profile-influencer");
      }

      // render badges
      const badgesEl = document.getElementById('profile-badges');
      badgesEl.innerHTML = '';
      const u = DB.users.find(x=>x.email===currentUser.email) || {};
      (u.badges||[]).forEach(b=>{
        const span = document.createElement('span');
        span.className = 'badge-pill';
        span.textContent = b;
        badgesEl.appendChild(span);
        // animate newly added badges briefly
        span.classList.add('new');
        setTimeout(()=>span.classList.remove('new'),800);
      });

      // simulate button (demo): approve last 3 requests for this user and re-evaluate badges
      const simBtn = document.getElementById('btn-sim-badges');
      if(simBtn){
        simBtn.addEventListener('click',()=>{
          const userReqs = DB.requests.filter(r=>r.userEmail===currentUser.email).sort((a,b)=>b.createdAt.localeCompare(a.createdAt));
          for(let i=0;i<3 && i<userReqs.length;i++) userReqs[i].status='approved';
          saveDB();
          awardBadgesForUser(currentUser.email);
          renderProfile();
        });
      }

      // initials/avatar
      const initials=currentUser.name.split(" ").map(p=>p[0]).join("").slice(0,2).toUpperCase()||"SA";
      profileAvatar.textContent=initials;
    }

    // Improve tab and screen UX: focus input when auth opened
    TAB_LOGIN.addEventListener("click",()=>{
      TAB_LOGIN.classList.add("active");
      TAB_REGISTER.classList.remove("active");
      VIEW_LOGIN.style.display="";
      VIEW_REGISTER.style.display="none";
      authMsg.textContent="";
      setTimeout(()=>loginEmail.focus(),70);
    });

    function showScreen(name){
      for(const key in screens){
        if(!screens[key]) continue;
        screens[key].classList.remove("active");
        screens[key].style.display = 'none';
      }
      if(screens[name]){
        screens[name].classList.add("active");
        screens[name].style.display = 'block';
      }
      if(name==='auth') setTimeout(()=>loginEmail.focus(),90);
    }

    function loginUser(){
      const email = loginEmail.value.trim();
      const pass = loginPass.value.trim();
      if(!email || !pass){
        authMsg.textContent="E-posta ve ÅŸifreyi gir.";
        return;
      }

      // (admin quick-login removed) 

      const u = findUserByEmail(email);
      if(!u || u.pass!==pass){
        console.warn('[auth] failed login attempt for', email);
        authMsg.textContent="E-posta veya ÅŸifre hatalÄ±.";
        return;
      }
      currentUser={name:u.name,email:u.email,plan:u.plan||"starter", role:u.role||'user'};
      saveDB();
      console.log('[auth] login success', currentUser.email, 'role=', currentUser.role);
      // remember me: persist user's email for convenience (demo only)
      try{ if(rememberMe && rememberMe.checked) localStorage.setItem('sparkad-last-email', currentUser.email); else localStorage.removeItem('sparkad-last-email'); }catch(e){}

      // If admin, go straight to admin panel
      if(currentUser.role==='admin'){
        authMsg.textContent='Admin olarak giriÅŸ yapÄ±ldÄ±.';
        updateTopbar();
        applyPlanTheme(currentUser.plan||'admin');
        setTimeout(()=>{ try{ renderAdmin(); }catch(e){} },120);
        return;
      }

      showWelcome(currentUser.name);
      setTimeout(()=>{
        updateTopbar();
        applyPlanTheme(currentUser.plan);
        renderUserDashboard();
        renderHome();
        showScreen("home");
        const firstCard = document.querySelector('#screen-home .card');
        if(firstCard){
          firstCard.classList.add('pulse');
          setTimeout(()=>firstCard.classList.remove('pulse'),1000);
        }
      },700);
    }

    btnRegister.addEventListener("click",registerUser);
    btnLogin.addEventListener("click",loginUser);

    document.getElementById("btn-forgot").addEventListener("click",()=>{
      authMsg.textContent="Bu demo sÃ¼rÃ¼mde gerÃ§ek ÅŸifre sÄ±fÄ±rlama yok, istersen yeni hesap aÃ§abilirsin.";
    });

    const homeTitle = document.getElementById("home-title");
    const homeSub = document.getElementById("home-sub");
    const homeSummary = document.getElementById("home-summary");

    function getPlanMeta(planId){
      const p = DB.plans.find(pl=>pl.id===planId);
      if(!p){
        return {label:"Starter Ãœye",color:"standard",perks:["Temel haklar"]};
      }
      let label = p.name+" Ãœyesi";
      if(p.id==="influencer") label="Influencer MÃ¼ÅŸterisi ğŸ‘‘";
      const perks = [];
      if(p.id==="starter"){
        perks.push("AylÄ±k 1â€“2 kÄ±sa reklam brifi","Temel yapay zekÃ¢ Ã¶nerileri","Standart hÄ±z");
      }else if(p.id==="pro"){
        perks.push("AylÄ±k 4â€“5 brif","Morâ€“mavi neon AI fikirleri","Panelde mor rozet");
      }else if(p.id==="influencer"){
        perks.push("Gold animasyonlu profil kartÄ±","En detaylÄ± AI kampanya fikirleri","Ä°sim altÄ±n tonlarÄ±yla Ã¶ne Ã§Ä±kar");
      }else{
        perks.push(p.perks);
      }
      return {label,color:p.color||"standard",perks};
    }

    // --- ADMIN: role-tabanlÄ± yetkilendirme ve render fonksiyonlarÄ± ---
    function ensureAdmin(){
      const role = currentUser && currentUser.role;
      const isAdmin = Boolean(role && String(role).toLowerCase() === 'admin');
      if(!isAdmin) console.warn('[auth] ensureAdmin=false, currentUser=', currentUser);
      return isAdmin;
    }

    function logAdmin(action,target,note){ try{ DB.adminLogs = DB.adminLogs || []; DB.adminLogs.unshift({ admin: currentUser ? currentUser.email : 'unknown', action, target, note:note||'', ts: Date.now() }); saveDB(); }catch(e){}
    }

    function showAdminSection(section){
      const sections = ['users','requests','community','messages','pricing','logs'];
      sections.forEach(s=>{ const el=document.getElementById('admin-'+s); if(el) el.style.display = (s===section ? '' : 'none'); });
      // active tab
      sections.forEach(s=>{ const btn = document.getElementById('admin-tab-'+s); if(btn){ if(s===section) btn.classList.add('primary'); else btn.classList.remove('primary'); } });
      // render section content when shown
      if(section==='users') renderAdminUsers();
      if(section==='requests') renderAdminRequests();
      if(section==='community') renderAdminCommunity();
      if(section==='messages') renderAdminMessages();
      if(section==='pricing') renderAdminPricing();
      if(section==='logs') renderAdminLogs();
    }

    function renderAdmin(){ if(!ensureAdmin()) return; showScreen('admin'); showAdminSection('users'); }

    function renderAdminUsers(){ if(!ensureAdmin()) return; const el=document.getElementById('admin-users'); el.innerHTML='';
      // bulk actions row
      const bulk = document.createElement('div'); bulk.style.display='flex'; bulk.style.gap='8px'; bulk.style.alignItems='center'; bulk.style.marginBottom='6px';
      const selectAll = document.createElement('button'); selectAll.className='btn-sm'; selectAll.textContent='TÃ¼mÃ¼nÃ¼ seÃ§'; selectAll.addEventListener('click',()=>{ document.querySelectorAll('#admin-users input[type=checkbox]').forEach(cb=>cb.checked=true); });
      const deselectAll = document.createElement('button'); deselectAll.className='btn-sm'; deselectAll.textContent='SeÃ§imi kaldÄ±r'; deselectAll.addEventListener('click',()=>{ document.querySelectorAll('#admin-users input[type=checkbox]').forEach(cb=>cb.checked=false); });
      const bulkCreditBtn = document.createElement('button'); bulkCreditBtn.className='btn-sm primary'; bulkCreditBtn.textContent='SeÃ§ililere Kredi Ver'; bulkCreditBtn.addEventListener('click',()=>{
        const amt = Number(prompt('KaÃ§ kredi verilsin?','10')||'0'); if(!amt) return; const note = prompt('Hediye notu (opsiyonel):','')||''; const checked = Array.from(document.querySelectorAll('#admin-users input[type=checkbox]:checked')).map(x=>x.getAttribute('data-email'));
        if(!checked.length){ alert('LÃ¼tfen Ã¶nce kullanÄ±cÄ± seÃ§in.'); return; }
        DB.users.forEach(u=>{ if(checked.includes(u.email)) u.credits=(u.credits||0)+amt; }); saveDB(); logAdmin('bulk-credit', JSON.stringify(checked), note); renderAdminUsers(); alert('Kredi verildi.');
      });
      const everyoneCreditBtn = document.createElement('button'); everyoneCreditBtn.className='btn-sm'; everyoneCreditBtn.textContent='Herkese Kredi Ver'; everyoneCreditBtn.addEventListener('click',()=>{
        const amt = Number(prompt('KaÃ§ kredi verilsin herkes iÃ§in?','10')||'0'); if(!amt) return; const note = prompt('Hediye notu (opsiyonel):','')||''; DB.users.forEach(u=>{ if(u.role!=='admin') u.credits=(u.credits||0)+amt; }); saveDB(); logAdmin('global-credit','all',note); renderAdminUsers(); alert('TÃ¼m kullanÄ±cÄ±lara kredi verildi.');
      });
      bulk.appendChild(selectAll); bulk.appendChild(deselectAll); bulk.appendChild(bulkCreditBtn); bulk.appendChild(everyoneCreditBtn); el.appendChild(bulk);

      DB.users.forEach(u=>{
        const row = document.createElement('div'); row.className='list-item';
        const left = document.createElement('div'); left.style.display='flex'; left.style.alignItems='center'; left.style.gap='10px';
        const cb = document.createElement('input'); cb.type='checkbox'; cb.setAttribute('data-email', u.email);
        const strong = document.createElement('strong'); strong.textContent = u.name + (u.role==='admin' ? ' (Admin)' : '');
        left.appendChild(cb); left.appendChild(strong);
        const meta = document.createElement('div'); meta.className='muted small'; meta.style.marginTop='6px'; meta.textContent = u.email + ' â€¢ krediler: '+(u.credits||0);
        // per-user controls
        const controls = document.createElement('div'); controls.style.marginTop='8px'; controls.style.display='flex'; controls.style.gap='6px';
        const creditInput = document.createElement('input'); creditInput.type='number'; creditInput.min=1; creditInput.value=10; creditInput.style.width='84px';
        const creditBtn = document.createElement('button'); creditBtn.className='btn-sm'; creditBtn.textContent='Kredi Ver'; creditBtn.addEventListener('click',()=>{ const amt=Number(creditInput.value||0); if(!amt) return; u.credits=(u.credits||0)+amt; saveDB(); logAdmin('credit',u.email,'Per-user credit'); renderAdminUsers(); alert(u.name+' kullanÄ±cÄ±sÄ±na '+amt+' kredi verildi.'); });
        const planSel = document.createElement('select'); DB.plans.filter(p=>p.type==='subscription').forEach(p=>{ const opt=document.createElement('option'); opt.value=p.id; opt.textContent=p.name; if(p.id===u.plan) opt.selected=true; planSel.appendChild(opt); }); planSel.addEventListener('change',()=>{ u.plan = planSel.value; saveDB(); logAdmin('plan-change',u.email,u.plan); renderAdminUsers(); alert(u.name+' paket deÄŸiÅŸti.'); });
        const delBtn = document.createElement('button'); delBtn.className='btn-sm danger'; delBtn.textContent='Sil'; delBtn.addEventListener('click',()=>{ if(u.role==='admin'){ alert('Admin kullanÄ±cÄ± silinemez.'); return; } if(!confirm('KullanÄ±cÄ±yÄ± silmek istediÄŸine emin misin?')) return; DB.users=DB.users.filter(x=>x.email!==u.email); saveDB(); logAdmin('delete-user',u.email); renderAdminUsers(); });
        controls.appendChild(creditInput); controls.appendChild(creditBtn); controls.appendChild(planSel); controls.appendChild(delBtn);

        row.appendChild(left); row.appendChild(meta); row.appendChild(controls);
        el.appendChild(row);
      });
    }

    function renderAdminRequests(){ if(!ensureAdmin()) return; const el=document.getElementById('admin-requests'); el.innerHTML='';
      DB.requests.forEach(r=>{
        const item=document.createElement('div'); item.className='list-item';
        const head=document.createElement('div'); head.style.display='flex'; head.style.justifyContent='space-between';
        const strong=document.createElement('strong'); strong.textContent = r.brand + ' â€“ '+r.product;
        const status=document.createElement('span'); status.className='pill-small '+(r.status==='approved'?'green':r.status==='rejected'?'orange':'gray'); status.textContent = r.status==='approved'?'OnaylandÄ±': r.status==='rejected'?'Reddedildi':'Bekliyor';
        head.appendChild(strong); head.appendChild(status);
        const meta=document.createElement('div'); meta.className='muted small'; meta.textContent = r.userName + ' ('+r.userEmail+') â€¢ '+new Date(r.createdAt).toLocaleString('tr-TR');
        const body=document.createElement('div'); body.style.marginTop='6px'; body.textContent = r.details;
        const actions=document.createElement('div'); actions.style.marginTop='8px'; actions.style.display='flex'; actions.style.gap='6px';
        const ok = document.createElement('button'); ok.className='btn-sm primary'; ok.textContent='Onayla'; ok.addEventListener('click',()=>{ if(r.status==='approved') return; const note = prompt('Onay notu (opsiyonel):','')||''; r.status='approved'; r.adminNote=note; saveDB(); logAdmin('approve-request',r.id,note); renderAdminRequests(); });
        const no = document.createElement('button'); no.className='btn-sm danger'; no.textContent='Reddet'; no.addEventListener('click',()=>{ if(r.status==='rejected') return; const note = prompt('Reddetme notu (opsiyonel):','')||''; r.status='rejected'; r.adminNote=note; saveDB(); logAdmin('reject-request',r.id,note); renderAdminRequests(); });
        actions.appendChild(ok); actions.appendChild(no);
        item.appendChild(head); item.appendChild(meta); item.appendChild(body); item.appendChild(actions); el.appendChild(item);
      });
    }

    function renderAdminCommunity(){ if(!ensureAdmin()) return; const el=document.getElementById('admin-community'); el.innerHTML='';
      const tools = document.createElement('div'); tools.style.display='flex'; tools.style.gap='8px'; tools.style.marginBottom='8px';
      const clearAll = document.createElement('button'); clearAll.className='btn-sm danger'; clearAll.textContent='TÃ¼mÃ¼nÃ¼ Temizle'; clearAll.addEventListener('click',()=>{ if(!confirm('Topluluk mesajlarÄ±nÄ± tamamen silmek istediÄŸine emin misin?')) return; DB.communityPosts=[]; saveDB(); logAdmin('clear-community','all'); renderAdminCommunity(); alert('Topluluk mesajlarÄ± silindi.'); });
      tools.appendChild(clearAll); el.appendChild(tools);
      DB.communityPosts.forEach(p=>{ const item=document.createElement('div'); item.className='list-item'; const strong=document.createElement('strong'); strong.textContent=p.author+' â€¢ '+new Date(p.createdAt).toLocaleString('tr-TR'); const body=document.createElement('div'); body.style.marginTop='6px'; body.textContent=p.text; const del=document.createElement('button'); del.className='btn-sm danger'; del.textContent='Sil'; del.addEventListener('click',()=>{ if(!confirm('Bu mesajÄ± silmek istediÄŸine emin misin?')) return; DB.communityPosts=DB.communityPosts.filter(x=>x!==p); saveDB(); logAdmin('delete-community',p.id||p.createdAt); renderAdminCommunity(); }); item.appendChild(strong); item.appendChild(body); item.appendChild(del); el.appendChild(item); });
    }

    function renderAdminMessages(){ if(!ensureAdmin()) return; const el=document.getElementById('admin-messages'); el.innerHTML='';
      const tools = document.createElement('div'); tools.style.display='flex'; tools.style.gap='8px'; tools.style.marginBottom='8px';
      const clearAll = document.createElement('button'); clearAll.className='btn-sm danger'; clearAll.textContent='TÃ¼mÃ¼nÃ¼ Temizle'; clearAll.addEventListener('click',()=>{ if(!confirm('TÃ¼m mesajlarÄ± silmek istediÄŸine emin misin?')) return; DB.messages=[]; saveDB(); logAdmin('clear-messages','all'); renderAdminMessages(); alert('Mesajlar silindi.'); });
      tools.appendChild(clearAll); el.appendChild(tools);
      DB.messages.forEach(m=>{ const item=document.createElement('div'); item.className='list-item'; const strong=document.createElement('strong'); strong.textContent=m.userEmail+' â€¢ '+new Date(m.createdAt).toLocaleString('tr-TR'); const body=document.createElement('div'); body.style.marginTop='6px'; body.textContent=m.text; const del=document.createElement('button'); del.className='btn-sm danger'; del.textContent='Sil'; del.addEventListener('click',()=>{ if(!confirm('Bu mesajÄ± silmek istediÄŸine emin misin?')) return; DB.messages=DB.messages.filter(x=>x!==m); saveDB(); logAdmin('delete-message',m.id||m.createdAt); renderAdminMessages(); }); item.appendChild(strong); item.appendChild(body); item.appendChild(del); el.appendChild(item); });
    }

    function renderAdminPricing(){ if(!ensureAdmin()) return; const el=document.getElementById('admin-pricing'); el.innerHTML='';
      DB.plans.forEach(p=>{ const card=document.createElement('div'); card.className='price-card'; const name=document.createElement('div'); name.className='price-name'; name.textContent=p.name; const tag=document.createElement('div'); tag.className='price-tag'; tag.textContent=p.type==='subscription'?'Abonelik Paketi':'Kredi Paketi'; const value=document.createElement('div'); value.className='price-value'; value.textContent=p.priceTl.toLocaleString('tr-TR')+' TL'; const note=document.createElement('div'); note.className='price-note'; note.textContent=p.perks; const btn=document.createElement('button'); btn.className='btn-sm danger'; btn.textContent='Sil'; btn.addEventListener('click',()=>{ if(!confirm('Paketi silmek istediÄŸine emin misin?')) return; DB.plans=DB.plans.filter(x=>x.id!==p.id); saveDB(); logAdmin('delete-plan',p.id); renderAdminPricing(); renderUserPricing(); }); card.appendChild(name); card.appendChild(tag); card.appendChild(value); card.appendChild(note); card.appendChild(btn); el.appendChild(card); });
      // Add plan form
      const form = document.createElement('div'); form.style.marginTop='12px'; form.innerHTML = '<div class="form-grid" style="margin-top:8px;"><div><label>Yeni Paket AdÄ±</label><input id="admin-new-plan-name" placeholder="Spark Pro Plus" /></div><div><label>TÃ¼r</label><select id="admin-new-plan-type"><option value="subscription">Abonelik</option><option value="credits">Kredi Paketi</option></select></div><div><label>Fiyat (TL)</label><input id="admin-new-plan-price" type="number" min="0" value="1450" /></div><div><label>KÄ±sa Not</label><input id="admin-new-plan-perks" placeholder="AyrÄ±calÄ±k Ã¶zetini yaz" /></div></div><div class="form-actions"><button class="btn-sm primary" id="admin-add-plan">Paket Ekle</button></div>';
      el.appendChild(form);
      setTimeout(()=>{ const addBtn=document.getElementById('admin-add-plan'); if(addBtn){ addBtn.addEventListener('click',()=>{ const name=document.getElementById('admin-new-plan-name').value.trim(); const type=document.getElementById('admin-new-plan-type').value; const price=Number(document.getElementById('admin-new-plan-price').value||'0'); const perks=document.getElementById('admin-new-plan-perks').value.trim(); if(!name||!perks) return; DB.plans.push({ id:'p_'+Date.now(), name, type, priceTl:price, perks, color:type==='subscription'?'pro':'standard' }); saveDB(); logAdmin('add-plan',name); renderAdminPricing(); renderUserPricing(); document.getElementById('admin-new-plan-name').value=''; document.getElementById('admin-new-plan-perks').value=''; }); } },40);
    }

    function renderAdminLogs(){ if(!ensureAdmin()) return; const el=document.getElementById('admin-logs'); el.innerHTML=''; (DB.adminLogs||[]).forEach(l=>{ const item=document.createElement('div'); item.className='list-item'; const head=document.createElement('div'); head.style.display='flex'; head.style.justifyContent='space-between'; const strong=document.createElement('strong'); strong.textContent = l.action; const meta=document.createElement('div'); meta.className='muted small'; meta.textContent = l.admin + ' â€¢ ' + new Date(l.ts).toLocaleString('tr-TR'); const note=document.createElement('div'); note.style.marginTop='6px'; note.textContent = l.target + (l.note?(' â€¢ '+l.note):''); item.appendChild(head); item.appendChild(meta); item.appendChild(note); el.appendChild(item); }); }

    // admin tab buttons
    ['users','requests','community','messages','pricing','logs'].forEach(s=>{ const btn=document.getElementById('admin-tab-'+s); if(btn) btn.addEventListener('click',()=>{ if(!ensureAdmin()) return; showAdminSection(s); }); });

    // Quick admin actions removed (replaced by full tab UI)
    // (No-op)



    function renderHome(){
      if(!currentUser){
        homeTitle.textContent="Spark Ad Studio";
        homeSub.textContent="GiriÅŸ yaptÄ±ktan sonra Ã¶zet burada gÃ¶rÃ¼necek.";
        homeSummary.innerHTML="";
        return;
      }
      const meta = getPlanMeta(currentUser.plan);
      homeTitle.textContent="Merhaba, "+currentUser.name;
      homeSub.textContent="Åu an "+meta.label+" olarak giriÅŸ yaptÄ±n.";
      homeSummary.innerHTML="";
      const myReqs = DB.requests.filter(r=>r.userEmail===currentUser.email);
      const approved = myReqs.filter(r=>r.status==="approved").length;
      const pending = myReqs.filter(r=>r.status==="pending").length;
      const li1=document.createElement("li");
      li1.textContent="Toplam reklam isteÄŸin: "+myReqs.length;
      const li2=document.createElement("li");
      li2.textContent="Onaylanan istek sayÄ±n: "+approved;
      const li3=document.createElement("li");
      li3.textContent="Bekleyen istek sayÄ±n: "+pending;
      homeSummary.appendChild(li1);
      homeSummary.appendChild(li2);
      homeSummary.appendChild(li3);
    }

    const userWelcome = document.getElementById("user-welcome");
    const userPlanBadge = document.getElementById("user-plan-badge");
    const userPerksList = document.getElementById("user-perks");

    function renderUserDashboard(){
      if(!currentUser) return;
      const meta = getPlanMeta(currentUser.plan);
      userWelcome.textContent="HoÅŸ geldin, "+currentUser.name+"!";
      userPlanBadge.textContent=meta.label;
      userPlanBadge.className="tag "+(meta.color||"standard");
      userPerksList.innerHTML="";
      meta.perks.forEach(p=>{
        const li=document.createElement("li");
        li.textContent=p;
        userPerksList.appendChild(li);
      });
      renderProfile();
    }

    const reqBrand = document.getElementById("req-brand");
    const reqProduct = document.getElementById("req-product");
    const reqDetails = document.getElementById("req-details");
    const reqHint = document.getElementById("req-hint");
    document.getElementById("btn-send-request").addEventListener("click",()=>{
      if(!currentUser){
        reqHint.textContent="Ã–nce giriÅŸ yapmalÄ±sÄ±n.";
        showScreen("auth");
        return;
      }
      const brand=reqBrand.value.trim();
      const prod=reqProduct.value.trim();
      const det=reqDetails.value.trim();
      if(!brand||!prod||!det){
        reqHint.textContent="LÃ¼tfen tÃ¼m alanlarÄ± doldur.";
        return;
      }
      DB.requests.unshift({
        id:"r_"+Date.now(),
        userEmail:currentUser.email,
        userName:currentUser.name,
        brand,product:prod,details:det,
        status:"pending",
        createdAt:new Date().toISOString()
      });
      saveDB();
      reqHint.textContent="Ä°stek gÃ¶nderildi; onay bekleniyor.";
      reqBrand.value="";
      reqProduct.value="";
      reqDetails.value="";
      renderAdminRequests();
      renderHome();
    });

    const chatLog = document.getElementById("chat-log");
    const assistantInput = document.getElementById("assistant-input");
    const assistantSend = document.getElementById("assistant-send");
    const chatLog2 = document.getElementById("chat-log-2");
    const assistantInput2 = document.getElementById("assistant-input-2");
    const assistantSend2 = document.getElementById("assistant-send-2");

    function pushChat(where,who,text){
      const log = where==="main"?chatLog:chatLog2;
      const line=document.createElement("div");
      line.className="chat-line "+who;
      const bubble=document.createElement("div");
      bubble.className="chat-bubble";
      const meta=document.createElement("div");
      meta.className="chat-meta";
      meta.textContent = who==="me" ? (currentUser?.name||"Sen") : "Spark AI";
      const body=document.createElement("div");
      body.textContent=text;
      bubble.appendChild(meta);
      bubble.appendChild(body);
      line.appendChild(bubble);
      log.appendChild(line);
      log.scrollTop=log.scrollHeight;
    }

    function genAiAnswer(prompt) {
      const lower = prompt.toLowerCase();
      let base = "Reklam fikrini daha netleÅŸtirebilmen iÃ§in sana kÄ±sa bir Ã¶neri veriyorum. ";
      let idea =
        "15 saniyelik dikey bir video dÃ¼ÅŸÃ¼n: aÃ§Ä±lÄ±ÅŸta gÃ¼Ã§lÃ¼ bir gÃ¶rsel, ortada kulÃ¼bÃ¼n duygusunu gÃ¶steren kÄ±sa bir an, sonda da net bir Ã§aÄŸrÄ± ('Bize katÄ±l', 'Åimdi baÅŸvur' gibi).";

      if(lower.includes("okÃ§uluk")){
        idea =
          "Ã–nce hedefe doÄŸru uÃ§an oku gÃ¶ster, ardÄ±ndan tam isabet anÄ±nda hafif slow motion kullan. ÃœstÃ¼ne kÄ±sa bir slogan yaz: 'Hedefini sÃ¶yle, gerisini biz halledelim.' Son karede kulÃ¼bÃ¼n logosu ve iletiÅŸim bilgisi Ã§Ä±ksÄ±n.";
      }else if(lower.includes("forma")){
        idea =
          "Eski formadan yeni formaya geÃ§iÅŸ efekti kullan. Bir sporcu eski formayla kadraja girsin, dÃ¶nÃ¼ÅŸ hareketiyle yeni formaya geÃ§sin. AltÄ±nda 'Yeni sezon, yeni hedefler' yazsÄ±n ve fiyat + satÄ±ÅŸ noktasÄ± kÄ±saca gÃ¶rÃ¼nsÃ¼n.";
      }else if(lower.includes("turnuva") || lower.includes("yarÄ±ÅŸma")){
        idea =
          "Turnuva gÃ¼nÃ¼ iÃ§in kÄ±sa bir recap: 3â€“4 hÄ±zlÄ± kesit (Ä±sÄ±nma, atÄ±ÅŸ, sevinÃ§, alkÄ±ÅŸ). Ãœst yazÄ±da tarih ve isim olsun. Videonun sonunda 'Gelecek turnuvada sen de var mÄ±sÄ±n?' mesajÄ± gelsin.";
      }

      const meta = currentUser ? getPlanMeta(currentUser.plan) : null;
      let level = "Temel seviyede, kÄ±sa ama uygulanabilir bir Ã¶neri sunuyorum.";
      if(meta){
        if(meta.color==="pro"){
          level="Pro seviyede, biraz daha detaylÄ± ve odaklÄ± bir Ã¶neri sunuyorum.";
        }else if(meta.color==="influencer"){
          level="Influencer seviyesinde olduÄŸun iÃ§in daha stratejik ve kampanya odaklÄ± bir Ã¶neri sunuyorum.";
        }
      }
      return base+level+" Ã–nerim: "+idea;
    }

    function handleAssistant(where){
      const input = where==="main"?assistantInput:assistantInput2;
      const text = input.value.trim();
      if(!text) return;
      pushChat(where,"me",text);
      input.value="";
      const ans = genAiAnswer(text);
      setTimeout(()=>{
        pushChat(where,"ai",ans);
        DB.messages.push({
          id:"m_"+Date.now(),
          fromEmail:currentUser?currentUser.email:"misafir",
          text,
          answer:ans,
          createdAt:new Date().toISOString()
        });
        saveDB();
      },200);
    }

    assistantSend.addEventListener("click",()=>handleAssistant("main"));
    assistantInput.addEventListener("keydown",e=>{
      if(e.key==="Enter"){e.preventDefault();handleAssistant("main");}
    });
    assistantSend2.addEventListener("click",()=>handleAssistant("full"));
    assistantInput2.addEventListener("keydown",e=>{
      if(e.key==="Enter"){e.preventDefault();handleAssistant("full");}
    });

    const communityText = document.getElementById("community-text");
    const communityHint = document.getElementById("community-hint");
    const communityList = document.getElementById("community-list");

    function renderCommunity(){
      communityList.innerHTML="";
      if(!DB.communityPosts.length){
        const empty=document.createElement("div");
        empty.className="list-item";
        empty.textContent="HenÃ¼z mesaj yok. Ä°lk mesajÄ± sen atabilirsin ğŸ¯";
        communityList.appendChild(empty);
        return;
      }
      DB.communityPosts.forEach(p=>{
        const item=document.createElement("div");
        item.className="list-item";
        const label=document.createElement("div");
        label.className="label-row";
        const strong=document.createElement("strong");
        strong.textContent=p.userName;
        const pill=document.createElement("span");
        pill.className="pill-small blue";
        pill.textContent=p.userEmail;
        label.appendChild(strong);
        label.appendChild(pill);
        const meta=document.createElement("div");
        meta.className="list-meta";
        meta.textContent=new Date(p.createdAt).toLocaleString("tr-TR");
        const body=document.createElement("div");
        body.style.marginTop="4px";
        body.textContent=p.text;
        item.appendChild(label);
        item.appendChild(meta);
        item.appendChild(body);
        communityList.appendChild(item);
      });
    }

    document.getElementById("btn-community-post").addEventListener("click",()=>{
      if(!currentUser){
        communityHint.textContent="Mesaj gÃ¶ndermek iÃ§in giriÅŸ yapmalÄ±sÄ±n.";
        showScreen("auth");
        return;
      }
      const text=communityText.value.trim();
      if(!text){
        communityHint.textContent="LÃ¼tfen bir ÅŸeyler yaz.";
        return;
      }
      DB.communityPosts.unshift({
        id:"c_"+Date.now(),
        userName:currentUser.name,
        userEmail:currentUser.email,
        text,
        createdAt:new Date().toISOString()
      });
      saveDB();
      communityText.value="";
      communityHint.textContent="MesajÄ±n kaydedildi (demo).";
      renderCommunity();
    });



    const profileAvatar=document.getElementById("profile-avatar");
    const profileName=document.getElementById("profile-name");
    const profileEmail=document.getElementById("profile-email");
    const profilePlan=document.getElementById("profile-plan");
    const profileNameInput=document.getElementById("profile-name-input");
    const groupNameInput=document.getElementById("group-name-input");
    const groupSuggestions=document.getElementById("group-suggestions");
    const profileCard=document.getElementById("profile-card");



    document.getElementById("btn-save-profile").addEventListener("click",()=>{
      if(!currentUser) return;
      const newName=profileNameInput.value.trim();
      if(!newName) return;
      const u=findUserByEmail(currentUser.email);
      if(u) u.name=newName;
      currentUser.name=newName;
      saveDB();
      profileNameInput.value="";
      renderProfile();
      renderUserDashboard();
      renderHome();
    });

    document.getElementById("btn-create-group").addEventListener("click",()=>{
      const gName=groupNameInput.value.trim();
      groupSuggestions.innerHTML="";
      if(!gName) return;
      const example=DB.users.slice(0,5);
      if(!example.length){
        const li=document.createElement("li");
        li.textContent="Åu an baÅŸka kayÄ±tlÄ± kullanÄ±cÄ± yok. Yine de grup adÄ± Ã§ok iyi: "+gName;
        groupSuggestions.appendChild(li);
        return;
      }
      example.forEach(u=>{
        const li=document.createElement("li");
        li.textContent=`${gName} ekibi iÃ§in uygun aday: ${u.name} (${u.email})`;
        groupSuggestions.appendChild(li);
      });
    });

    const userPricingEl=document.getElementById("user-pricing");
    function renderUserPricing(){
      userPricingEl.innerHTML="";
      DB.plans.forEach(p=>{
        const card=document.createElement("div");
        card.className="price-card";
        const name=document.createElement("div");
        name.className="price-name";
        name.textContent=p.name;
        const tag=document.createElement("div");
        tag.className="price-tag";
        tag.textContent=p.type==="subscription"?"Abonelik":"Kredi Paketi (Demo)";
        const value=document.createElement("div");
        value.className="price-value";
        value.textContent=p.priceTl.toLocaleString("tr-TR")+" TL";
        const note=document.createElement("div");
        note.className="price-note";
        const usd=(p.priceTl/42.45).toFixed(1);
        const eur=(p.priceTl/49.6).toFixed(1);
        note.textContent=`${p.perks} â€¢ YaklaÅŸÄ±k ${usd} $ / ${eur} â‚¬ (sadece bilgi).`;
        const btn=document.createElement("button");
        btn.className="btn-sm primary";
        btn.textContent=p.type==="subscription"?"Bu pakete geÃ§ (demo)":"Bu krediyi al (demo)";
        btn.addEventListener("click",()=>purchasePlan(p.id));
        card.appendChild(name);
        card.appendChild(tag);
        card.appendChild(value);
        card.appendChild(note);
        card.appendChild(btn);
        userPricingEl.appendChild(card);
      });
    }

    function purchasePlan(planId){
      if(!currentUser){
        alert("Ã–nce giriÅŸ yapmalÄ±sÄ±n.");
        showScreen("auth");
        return;
      }
      const p=DB.plans.find(pl=>pl.id===planId);
      if(!p) return;
      const u=findUserByEmail(currentUser.email);
      if(!u) return;
      if(p.type==="subscription"){
        u.plan=planId;
        currentUser.plan=planId;
        saveDB();
        applyPlanTheme(planId);
        renderUserDashboard();
        renderUserPricing();
        alert(p.name+" paketine geÃ§tin (demo).");
      }else{
        const add = p.id==="credits10"?10:p.id==="credits25"?25:5;
        u.credits=(u.credits||0)+add;
        saveDB();
        renderUserDashboard();
        alert(p.name+" demo kredisi eklendi. Toplam kredin: "+u.credits);
      }
    }

    // Admin fonksiyonlarÄ± kaldÄ±rÄ±ldÄ± â€” yeniden tasarlanacak.



    // Admin navigation helpers removed.

    const settingsHint=document.getElementById("settings-hint");

    document.getElementById("btn-info-start").addEventListener("click",()=>showScreen("auth"));
    document.getElementById("btn-info-pricing").addEventListener("click",()=>{
      renderUserPricing();
      showScreen("pricing");
    });
    btnAuth.addEventListener("click",()=>showScreen("auth"));
    btnLogout.addEventListener("click",()=>{
      console.log('[auth] logging out user', currentUser && currentUser.email);
      currentUser=null;
      updateTopbar();
      applyPlanTheme("free");
      // After logout, go to auth screen so admin can login again quickly
      showScreen("auth");
      setTimeout(()=>{ try{ if(document.getElementById('login-email')) document.getElementById('login-email').focus(); }catch(e){} },80);
    });

    navInfo.addEventListener("click",()=>showScreen("info"));
    navHome.addEventListener("click",()=>{
      if(currentUser){
        renderHome();
        showScreen("home");
      }else{
        showScreen("info");
      }
    });
    navStudio.addEventListener("click",()=>{
      if(currentUser){
        renderUserDashboard();
        showScreen("user");
      }else{
        showScreen("auth");
      }
    });
    navCommunity.addEventListener("click",()=>{
      renderCommunity();
      showScreen("community");
    });
    navAssistant.addEventListener("click",()=>showScreen("assistant"));
    navPricing.addEventListener("click",()=>{
      renderUserPricing();
      showScreen("pricing");
    });
    navProfile.addEventListener("click",()=>{
      renderProfile();
      showScreen("profile");
    });
    navSettings.addEventListener("click",()=>{
      if(settingsHint){
        settingsHint.textContent="Tema pakete gÃ¶re otomatik: Starter=mavi, Spark Pro=mor, Influencer=gold animasyonlu.";
      }
      showScreen("settings");
    });
    // Admin top-nav: open admin panel (only when admin logged in)
    navAdmin.addEventListener("click",()=>{
      console.log('[nav] navAdmin clicked, currentUser=', currentUser);
      try{ renderAdmin(); }catch(e){ console.warn('[nav] renderAdmin failed', e); }
    });

    function renderAdmin(){ if(!ensureAdmin()){ console.warn('[nav] renderAdmin blocked: not admin'); return; } showScreen('admin'); showAdminSection('users'); }

    updateTopbar();
    renderUserPricing();
    renderCommunity();

    try{ const __last = localStorage.getItem('sparkad-last-email'); if(__last && document.getElementById('login-email')) document.getElementById('login-email').value=__last; }catch(e){}
    // Apply default accent based on current user plan (if logged in) or free otherwise
    try{ if(currentUser && currentUser.plan) applyPlanTheme(currentUser.plan); else applyPlanTheme('free'); }catch(e){ applyPlanTheme('free'); }

    console.log("Spark Ad Studio premium tema sÃ¼rÃ¼mÃ¼ yÃ¼klendi âœ…");
  </script>
</body>
</html>
