<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Spark Ad Studio</title>

<style>
body {
    margin:0;
    font-family:Arial, sans-serif;
    background:#111;
    color:white;
}

/* ÜST MENÜ */
header {
    background:#222;
    padding:15px;
    display:flex;
    justify-content:space-between;
    align-items:center;
}
header h1 {
    font-size:20px;
    margin:0;
}
header button {
    background:#ffcc00;
    border:none;
    padding:10px 15px;
    border-radius:6px;
    cursor:pointer;
    font-weight:bold;
}

/* SAYFA KUTUSU */
.page {
    display:none;
    padding:20px;
}

/* INPUT */
input,select,textarea {
    width:100%;
    padding:10px;
    margin-top:8px;
    margin-bottom:15px;
    border-radius:6px;
    border:none;
    font-size:16px;
}

/* FORM KUTUSU */
.box {
    background:#1c1c1c;
    padding:20px;
    border-radius:8px;
    margin-top:20px;
}

button.primary {
    width:100%;
    background:#ffcc00;
    border:none;
    padding:12px;
    border-radius:6px;
    font-weight:bold;
    cursor:pointer;
    font-size:17px;
}

/* ANA MENÜ */
nav {
    display:flex;
    justify-content:space-around;
    background:#222;
    padding:10px 0;
}
nav button {
    background:none;
    border:none;
    color:white;
    font-size:16px;
    cursor:pointer;
}

/* ADMİN MASA */
table {
    width:100%;
    border-collapse:collapse;
    margin-top:15px;
}
td, th {
    border:1px solid #555;
    padding:10px;
}

/* TEMA RENKLERİ */
.light {
    background:white;
    color:black;
}
.light header {
    background:#eee;
}
.light nav {
    background:#ddd;
}
.light .box {
    background:#f3f3f3;
}
.light input, .light textarea {
    background:white;
    color:black;
}

</style>
</head>

<body>

<header>
    <h1>Spark Ad Studio</h1>
    <button id="loginMenuBtn">Üye Ol / Giriş Yap</button>
</header>

<nav id="mainMenu" style="display:none;">
    <button onclick="showPage('home')">Ana Sayfa</button>
    <button onclick="showPage('createAd')">Reklam İste</button>
    <button onclick="showPage('messages')">Mesaj Gönder</button>
    <button onclick="showPage('settings')">Ayarlar</button>
    <button onclick="showPage('admin')" id="adminBtn" style="display:none;">Yönetici</button>
</nav>

<!-- GİRİŞ SAYFASI -->
<div class="page" id="loginPage" style="display:block;">
    <div class="box">
        <h2>Giriş Yap</h2>
        <input id="loginEmail" type="email" placeholder="E-posta">
        <input id="loginPass" type="password" placeholder="Şifre">
        <button class="primary" onclick="login()">Giriş Yap</button>

        <h3>Veya Üye Ol</h3>
        <input id="registerEmail" type="email" placeholder="E-posta">
        <input id="registerPass" type="password" placeholder="Şifre">
        <input id="registerName" type="text" placeholder="Adınız">
        <button class="primary" onclick="register()">Üye Ol</button>
    </div>

    <div class="box">
        <h2>Spark Ad Studio Nedir?</h2>
        <p>
            Bu platform kulüpler ve markalar için reklam içerikleri üretir.  
            Üyeler reklam isteği gönderebilir, mesaj yazabilir ve bildirimleri görebilir.
        </p>
    </div>
</div>

<!-- ANA SAYFA -->
<div class="page" id="home">
    <h2>Bildirimler</h2>
    <div id="notifications"></div>
</div>

<!-- REKLAM İSTE -->
<div class="page" id="createAd">
    <h2>Reklam İsteği Gönder</h2>
    <textarea id="adText" placeholder="Reklam detayını yaz..."></textarea>
    <button class="primary" onclick="sendAd()">Gönder</button>
</div>

<!-- MESAJ GÖNDER -->
<div class="page" id="messages">
    <h2>Yöneticiye Mesaj Gönder</h2>
    <textarea id="msgText" placeholder="Mesajınızı yazın..."></textarea>
    <button class="primary" onclick="sendMessage()">Gönder</button>
</div>

<!-- AYARLAR -->
<div class="page" id="settings">
    <h2>Tema Seç</h2>
    <select id="themeSelect" onchange="changeTheme()">
        <option value="dark">Koyu Tema</option>
        <option value="light">Açık Tema</option>
    </select>
</div>

<!-- ADMİN PANEL -->
<div class="page" id="admin">
    <h2>Yönetici Paneli</h2>

    <h3>Gelen Reklam İstekleri</h3>
    <table>
        <thead><tr><th>Kullanıcı</th><th>İstek</th><th>Onay</th></tr></thead>
        <tbody id="adminRequests"></tbody>
    </table>

    <h3>Mesajlar</h3>
    <table>
        <thead><tr><th>Kimden</th><th>Mesaj</th></tr></thead>
        <tbody id="adminMessages"></tbody>
    </table>

    <h3>Üyeler</h3>
    <div id="userList"></div>
</div>

<!-- FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
import { getFirestore, collection, addDoc, onSnapshot, getDocs } 
from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

const firebaseConfig = {
    apiKey: "AIzaSyDc6kmOfcRwWLFxPAKOqtB5w_QJkTdHqh8",
    authDomain: "spark-ad-studio.firebaseapp.com",
    projectId: "spark-ad-studio",
    storageBucket: "spark-ad-studio.firebasestorage.app",
    messagingSenderId: "91249468928",
    appId: "1:91249468928:web:6661ecd7e1ff1e92c41ae5",
    measurementId: "G-JW6S3PGH98"
};
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

let currentUser = null;

function showPage(id){
    document.querySelectorAll(".page").forEach(p => p.style.display="none");
    document.getElementById(id).style.display="block";
}

document.getElementById("loginMenuBtn").onclick = () => showPage("loginPage");
showPage("loginPage");

async function register(){
    const email = registerEmail.value;
    const pass = registerPass.value;
    const name = registerName.value;

    await addDoc(collection(db,"users"),{
        email,pass,name,role:"user"
    });

    alert("Kayıt başarılı!");
}

async function login(){
    const email = loginEmail.value;
    const pass = loginPass.value;

    const q = await getDocs(collection(db,"users"));
    let found = null;

    q.forEach(doc=>{
        const d = doc.data();
        if(d.email===email && d.pass===pass){
            found = {id:doc.id, ...d};
        }
    });

    if(!found){
        alert("Hatalı giriş");
        return;
    }

    currentUser = found;

    if(found.role==="admin"){
        document.getElementById("adminBtn").style.display="block";
    } else {
        document.getElementById("adminBtn").style.display="none";
    }

    document.getElementById("mainMenu").style.display="flex";
    showPage("home");
}

async function sendAd(){
    if(!currentUser){ alert("Giriş yap"); return; }

    await addDoc(collection(db,"requests"),{
        user: currentUser.name,
        text: adText.value,
        status:"bekliyor"
    });
    adText.value="";
    alert("İstek gönderildi!");
}

async function sendMessage(){
    if(!currentUser){ alert("Giriş yap"); return; }

    await addDoc(collection(db,"messages"),{
        user: currentUser.name,
        text: msgText.value
    });

    msgText.value="";
    alert("Mesaj gönderildi!");
}

function changeTheme(){
    const theme = themeSelect.value;
    if(theme==="light"){
        document.body.classList.add("light");
    } else {
        document.body.classList.remove("light");
    }
}

/* ADMİN GERÇEK ZAMANLI */
onSnapshot(collection(db,"requests"), snap=>{
    adminRequests.innerHTML="";
    snap.forEach(doc=>{
        const d = doc.data();
        adminRequests.innerHTML += `
        <tr>
            <td>${d.user}</td>
            <td>${d.text}</td>
            <td>${d.status}</td>
        </tr>`;
    });
});

onSnapshot(collection(db,"messages"), snap=>{
    adminMessages.innerHTML="";
    snap.forEach(doc=>{
        const d = doc.data();
        adminMessages.innerHTML += `
        <tr>
            <td>${d.user}</td>
            <td>${d.text}</td>
        </tr>`;
    });
});

onSnapshot(collection(db,"users"), snap=>{
    userList.innerHTML="";
    snap.forEach(doc=>{
        const d = doc.data();
        userList.innerHTML += `<p>${d.name} (${d.email})</p>`;
    });
});

</script>

</body>
</html>



